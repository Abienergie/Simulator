var mt=Object.defineProperty;var ut=(t,s,n)=>s in t?mt(t,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[s]=n;var X=(t,s,n)=>ut(t,typeof s!="symbol"?s+"":s,n);import{r as u,b as xt,u as J,d as V,L as $,N as ht,H as pt,e as gt,f as T,R as ft}from"./vendor-CbVJkecO.js";import{E as bt,a as B}from"./pdf-ChTLBbIY.js";import{R as Se,B as Ce,C as Pe,X as Ae,Y as Me,T as Ee,L as Ie,a as Q}from"./charts-CJ_PvRof.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}})();var qe={exports:{}},ne={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yt=u,jt=Symbol.for("react.element"),vt=Symbol.for("react.fragment"),Nt=Object.prototype.hasOwnProperty,wt=yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kt={key:!0,ref:!0,__self:!0,__source:!0};function $e(t,s,n){var a,l={},r=null,i=null;n!==void 0&&(r=""+n),s.key!==void 0&&(r=""+s.key),s.ref!==void 0&&(i=s.ref);for(a in s)Nt.call(s,a)&&!kt.hasOwnProperty(a)&&(l[a]=s[a]);if(t&&t.defaultProps)for(a in s=t.defaultProps,s)l[a]===void 0&&(l[a]=s[a]);return{$$typeof:jt,type:t,key:r,ref:i,props:l,_owner:wt.current}}ne.Fragment=vt;ne.jsx=$e;ne.jsxs=$e;qe.exports=ne;var e=qe.exports,We,Re=xt;We=Re.createRoot,Re.hydrateRoot;const Ve=u.createContext(void 0),Be="solar_client_data";function St(t){try{localStorage.setItem(Be,JSON.stringify(t))}catch(s){console.error("Error saving client data:",s)}}function Ct(){try{const t=localStorage.getItem(Be);return t?JSON.parse(t):null}catch(t){return console.error("Error loading client data:",t),null}}function Pt(){try{localStorage.clear();const t=sessionStorage.getItem("auth_token");t&&localStorage.setItem("auth_token",t)}catch(t){console.error("Error clearing client data:",t)}}const Fe={civilite:"",nom:"",prenom:"",telephone:"",email:""},le={rue:"",codePostal:"",ville:"",pays:"France",region:"",coordinates:void 0};function At({children:t}){const[s,n]=u.useState(Fe),[a,l]=u.useState(le);u.useEffect(()=>{const c=Ct();c&&(n(c.clientInfo),l(d=>({...le,...c.address})))},[]),u.useEffect(()=>{St({clientInfo:s,address:a})},[s,a]);const r=c=>{n(d=>({...d,...c}))},i=c=>{l(d=>({...d,...c}))},o=()=>{n({...Fe}),l({...le}),Pt()};return e.jsx(Ve.Provider,{value:{clientInfo:s,address:a,updateClientInfo:r,updateAddress:i,resetClientInfo:o},children:t})}function D(){const t=u.useContext(Ve);if(t===void 0)throw new Error("useClient must be used within a ClientProvider");return t}const ce=[{power:2.5,price:6890},{power:3,price:7890},{power:3.5,price:8890},{power:4,price:9890},{power:4.5,price:10890},{power:5,price:11890},{power:5.5,price:12890},{power:6,price:14890},{power:6.5,price:15890},{power:7,price:16890},{power:7.5,price:17890},{power:8,price:18890},{power:8.5,price:19890},{power:9,price:19890}],I={baseKwhPrice:.25,baseSellPrice:.1269,sellPriceDate:"2025-01-01",defaultAutoconsumption:75,defaultEnergyRevaluation:7,defaultSellIndexation:2,defaultPanelDegradation:-.2,installationPrices:ce,defaultSubsidyUnder3kw:220,defaultSubsidyOver3kw:160,defaultSubsidy9to36kw:110,defaultSubsidy36to100kw:80,subsidyDate:"2025-01-01"},Ue=u.createContext(void 0);function Mt({children:t}){const[s,n]=u.useState(()=>{try{const i={...I,baseKwhPrice:parseFloat(localStorage.getItem("base_kwh_price")||I.baseKwhPrice.toString()),baseSellPrice:parseFloat(localStorage.getItem("base_sell_price")||I.baseSellPrice.toString()),sellPriceDate:localStorage.getItem("sell_price_date")||I.sellPriceDate,defaultAutoconsumption:parseFloat(localStorage.getItem("default_autoconsumption")||I.defaultAutoconsumption.toString()),defaultEnergyRevaluation:parseFloat(localStorage.getItem("default_energy_revaluation")||I.defaultEnergyRevaluation.toString()),defaultSellIndexation:parseFloat(localStorage.getItem("default_sell_indexation")||I.defaultSellIndexation.toString()),defaultPanelDegradation:parseFloat(localStorage.getItem("default_panel_degradation")||I.defaultPanelDegradation.toString()),defaultSubsidyUnder3kw:parseFloat(localStorage.getItem("default_subsidy_under_3kw")||I.defaultSubsidyUnder3kw.toString()),defaultSubsidyOver3kw:parseFloat(localStorage.getItem("default_subsidy_over_3kw")||I.defaultSubsidyOver3kw.toString()),defaultSubsidy9to36kw:parseFloat(localStorage.getItem("default_subsidy_9to36kw")||I.defaultSubsidy9to36kw.toString()),defaultSubsidy36to100kw:parseFloat(localStorage.getItem("default_subsidy_36to100kw")||I.defaultSubsidy36to100kw.toString()),subsidyDate:localStorage.getItem("subsidy_date")||I.subsidyDate,installationPrices:[...ce]},o=localStorage.getItem("installation_prices");if(o)try{const c=JSON.parse(o);if(Array.isArray(c)){const d=c.filter(x=>x&&typeof x.power=="number"&&typeof x.price=="number"&&x.power>9);i.installationPrices=[...ce,...d].sort((x,p)=>x.power-p.power)}}catch(c){console.error("Erreur lors du parsing des prix personnalisés:",c)}return i}catch(i){return console.error("Erreur lors du chargement des paramètres:",i),I}}),a=i=>{n(o=>{const c={...o,...i};return Object.entries(i).forEach(([d,x])=>{if(d==="installationPrices"){const p=x.filter(h=>h.power>9);localStorage.setItem("installation_prices",JSON.stringify(p))}else localStorage.setItem(d.replace(/([A-Z])/g,"_$1").toLowerCase(),typeof x=="object"?JSON.stringify(x):x.toString())}),c})},l=(i,o)=>{if(i<=0||o<=0){console.error("Puissance et prix doivent être positifs");return}n(c=>{const d=c.installationPrices.findIndex(h=>Math.abs(h.power-i)<.01);let x;d>=0?(x=[...c.installationPrices],x[d]={power:i,price:o}):x=[...c.installationPrices,{power:i,price:o}],x.sort((h,g)=>h.power-g.power);const p=x.filter(h=>h.power>9);return localStorage.setItem("installation_prices",JSON.stringify(p)),{...c,installationPrices:x}})},r=i=>{if(i<=9){console.error("Impossible de supprimer les prix par défaut");return}n(o=>{const c=o.installationPrices.filter(x=>Math.abs(x.power-i)>=.01),d=c.filter(x=>x.power>9);return localStorage.setItem("installation_prices",JSON.stringify(d)),{...o,installationPrices:c}})};return e.jsx(Ue.Provider,{value:{settings:s,updateSettings:a,addInstallationPrice:l,removeInstallationPrice:r},children:t})}function re(){const t=u.useContext(Ue);if(t===void 0)throw new Error("useFinancialSettings must be used within a FinancialSettingsProvider");return t}/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Et={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),b=(t,s)=>{const n=u.forwardRef(({color:a="currentColor",size:l=24,strokeWidth:r=2,absoluteStrokeWidth:i,className:o="",children:c,...d},x)=>u.createElement("svg",{ref:x,...Et,width:l,height:l,stroke:a,strokeWidth:i?Number(r)*24/Number(l):r,className:["lucide",`lucide-${It(t)}`,o].join(" "),...d},[...s.map(([p,h])=>u.createElement(p,h)),...Array.isArray(c)?c:[c]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=b("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=b("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=b("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=b("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=b("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=b("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=b("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=b("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=b("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=b("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=b("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=b("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=b("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=b("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=b("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=b("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=b("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=b("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=b("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=b("DoorOpen",[["path",{d:"M13 4h3a2 2 0 0 1 2 2v14",key:"hrm0s9"}],["path",{d:"M2 20h3",key:"1gaodv"}],["path",{d:"M13 20h9",key:"s90cdi"}],["path",{d:"M10 12v.01",key:"vx6srw"}],["path",{d:"M13 4.562v16.157a1 1 0 0 1-1.242.97L5 20V5.562a2 2 0 0 1 1.515-1.94l4-1A2 2 0 0 1 13 4.561Z",key:"199qr4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=b("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=b("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=b("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=b("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=b("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=b("HeartHandshake",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M12 5 9.04 7.96a2.17 2.17 0 0 0 0 3.08v0c.82.82 2.13.85 3 .07l2.07-1.9a2.82 2.82 0 0 1 3.79 0l2.96 2.66",key:"12sd6o"}],["path",{d:"m18 15-2-2",key:"60u0ii"}],["path",{d:"m15 18-2-2",key:"6p76be"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=b("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=b("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=b("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=b("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=b("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=b("LineChart",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=b("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=b("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=b("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=b("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=b("PiggyBank",[["path",{d:"M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2h0V5z",key:"uf6l00"}],["path",{d:"M2 9v1c0 1.1.9 2 2 2h1",key:"nm575m"}],["path",{d:"M16 11h0",key:"k2aug8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=b("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=b("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=b("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=b("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=b("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=b("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=b("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=b("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=b("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=b("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=b("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=b("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=b("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=b("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=b("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=b("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function H(t="smooth"){window.scrollTo({top:0,behavior:t})}function os(){const t=J(),s=V(),{clientInfo:n}=D(),a=!!(n.civilite&&n.nom&&n.prenom&&n.telephone&&n.email),l=[{path:"/",label:"Dimensionnement",icon:Ot,description:"Caractéristiques de votre installation"},{path:"/projection",label:"Projection financière",icon:be,description:"Simulation de rentabilité"},{path:"/eligibilite",label:"Tester mon éligibilité",icon:Lt,description:"Vérification des conditions"},{path:"/rapport",label:"Rapport",icon:Vt,description:"Rapport détaillé"},{path:"/modalites-abonnement",label:"Modalités d'abonnement",icon:z,description:"Conditions et engagements",isStatic:!0},{path:"/modalites-sortie",label:"Modalités de sortie",icon:qt,description:"Conditions de résiliation",isStatic:!0}],r=(i,o)=>{if(o||i==="/abie-link"||i==="/settings"||i==="/agence"){s(i),H();return}if(!a&&i!=="/"){alert("Veuillez remplir tous les champs obligatoires avant de continuer.");return}s(i),H()};return e.jsx("nav",{className:"w-64 bg-white border-r border-gray-200 h-full py-6",children:e.jsxs("div",{className:"px-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Menu"}),e.jsx("div",{className:"space-y-1",children:l.map((i,o)=>{const c=i.icon,d=t.pathname===i.path,x=!i.isStatic&&!a&&i.path!=="/";return e.jsxs("button",{onClick:()=>r(i.path,i.isStatic),disabled:x,className:`w-full group flex items-start gap-4 p-3 rounded-lg transition-colors ${d?"bg-blue-50 text-blue-600":x?"text-gray-400 cursor-not-allowed":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx("div",{className:`flex-shrink-0 flex items-center justify-center w-8 h-8 rounded-full bg-white border text-sm font-medium ${d?"border-blue-200":"border-gray-200"}`,children:o+1}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:`h-5 w-5 ${d?"text-blue-500":x?"text-gray-300":"text-gray-400"}`}),e.jsx("span",{className:"text-sm font-medium",children:i.label})]}),e.jsx("p",{className:`mt-1 text-xs ${x?"text-gray-400":"text-gray-500"}`,children:i.description})]})]},i.path)})}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200 space-y-2",children:[e.jsxs("button",{onClick:()=>r("/abie-link"),className:`w-full group flex items-center gap-3 p-3 rounded-lg transition-colors ${t.pathname==="/abie-link"?"bg-green-50 text-green-600":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(ae,{className:`h-5 w-5 ${t.pathname==="/abie-link"?"text-green-500":"text-gray-400"}`}),e.jsx("span",{className:"text-sm font-medium",children:"Abie Link"})]}),e.jsxs("button",{onClick:()=>r("/agence"),className:`w-full group flex items-center gap-3 p-3 rounded-lg transition-colors ${t.pathname==="/agence"?"bg-purple-50 text-purple-600":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(Ke,{className:`h-5 w-5 ${t.pathname==="/agence"?"text-purple-500":"text-gray-400"}`}),e.jsx("span",{className:"text-sm font-medium",children:"Info agence"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:()=>r("/settings"),className:`w-full group flex items-center gap-3 p-3 rounded-lg transition-colors ${t.pathname==="/settings"?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(ts,{className:`h-5 w-5 ${t.pathname==="/settings"?"text-gray-900":"text-gray-400"}`}),e.jsx("span",{className:"text-sm font-medium",children:"Réglages"})]})})]})})}function cs({children:t}){const[s,n]=u.useState(window.innerWidth>=1024);return u.useEffect(()=>{const a=()=>{window.innerWidth>=1024?n(!0):n(!1)};return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),e.jsxs("div",{className:"min-h-screen",children:[e.jsxs("div",{className:"fixed inset-y-0 left-0 z-30",children:[e.jsx("div",{className:`fixed inset-y-0 w-64 bg-white border-r border-gray-200 transition-transform duration-300 ease-in-out ${s?"translate-x-0":"-translate-x-full"}`,children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx(os,{})})}),e.jsx("button",{onClick:()=>n(!s),className:`fixed top-4 bg-white rounded-full p-1 shadow-md border border-gray-200 transition-transform duration-300 ease-in-out lg:hidden ${s?"left-[246px]":"left-0"}`,"aria-label":s?"Réduire le menu":"Ouvrir le menu",children:s?e.jsx(_t,{className:"h-4 w-4 text-gray-600"}):e.jsx(U,{className:"h-4 w-4 text-gray-600"})})]}),s&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 transition-opacity lg:hidden z-20",onClick:()=>n(!1)}),e.jsx("div",{className:`${s?"lg:pl-64":""}`,children:t})]})}function De(){return e.jsx("div",{className:"h-32",children:e.jsx("img",{src:"https://i.postimg.cc/7Z49VZpw/ABI-e-nergie-Blanc.png",alt:"ABI Énergie",className:"h-full w-auto"})})}function ds(){const t=J();return["/modalites-abonnement","/modalites-sortie"].includes(t.pathname)?e.jsx("header",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(De,{})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(K,{className:"h-6 w-6 sm:h-8 sm:w-8 text-amber-400"}),e.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-900",children:"Simulateur Solaire"})]})]})})}):e.jsxs("header",{className:"relative w-full bg-gradient-to-b from-blue-900 to-blue-700",children:[e.jsx("div",{className:"absolute inset-0",children:e.jsx("img",{src:"https://images.unsplash.com/photo-1508514177221-188b1cf16e9d?auto=format&fit=crop&q=80",alt:"Solar panels under blue sky with sun",className:"w-full h-80 object-cover brightness-50"})}),e.jsx("div",{className:"relative z-10 h-80",children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6 sm:px-6 lg:px-8 lg:pl-72",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(De,{})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(K,{className:"h-6 w-6 sm:h-8 sm:w-8 text-amber-400"}),e.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-white",children:"Simulateur Solaire"})]})]})})}),e.jsx("div",{className:"flex-1 flex items-center",children:e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 lg:pl-72",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-white mb-3",children:"Optimisez votre transition énergétique"}),e.jsx("p",{className:"text-base sm:text-lg text-gray-200 max-w-2xl mx-auto",children:"Calculez votre potentiel solaire et découvrez les économies possibles avec une installation photovoltaïque adaptée à vos besoins"})]})})})})]})})]})}const ms={"01":1320,"02":1140,"03":1290,"04":1540,"05":1540,"06":1590,"07":1450,"08":1070,"09":1350,10:1210,11:1580,12:1410,13:1580,14:1170,15:1290,16:1340,17:1450,18:1250,19:1320,21:1240,22:1200,23:1280,24:1360,25:1240,26:1470,27:1220,28:1220,29:1200,30:1580,31:1430,32:1400,33:1400,34:1580,35:1220,36:1280,37:1280,38:1390,39:1270,40:1380,41:1250,42:1380,43:1330,44:1290,45:1220,46:1390,47:1420,48:1380,49:1290,50:1150,51:1170,52:1170,53:1220,54:1170,55:1170,56:1290,57:1220,58:1270,59:1050,60:1180,61:1180,62:1120,63:1300,64:1340,65:1350,66:1580,67:1190,68:1190,69:1340,70:1190,71:1290,72:1220,73:1380,74:1310,75:1140,76:1140,77:1140,78:1180,79:1330,80:1120,81:1410,82:1420,83:1560,84:1630,85:1340,86:1310,87:1320,88:1220,89:1210,90:1190,91:1210,92:1180,93:1180,94:1180,95:1180,971:2e3,972:2e3,973:1800,974:2200,976:1800,"2B":1580};function we(t){const s=ms[t];return s||(console.warn(`Pas de données d'ensoleillement pour le département ${t}, utilisation de la moyenne nationale`),1300)}const ie={[-90]:{0:1,10:.99,15:.99,20:.97,25:.97,30:.94,35:.94,40:.9,45:.9,50:.84,55:.84,60:.81,90:.58},90:{0:1,10:.99,15:.99,20:.97,25:.97,30:.94,35:.94,40:.9,45:.9,50:.84,55:.84,60:.81,90:.58},0:{0:1,10:1.1,15:1.1,20:1.14,25:1.14,30:1.15,35:1.15,40:1.14,45:1.14,50:1.1,55:1.1,60:1.08,90:.79},[-45]:{0:1,10:1.07,15:1.07,20:1.09,25:1.09,30:1.09,35:1.09,40:1.07,45:1.07,50:1.03,55:1.03,60:1,90:.74},45:{0:1,10:1.07,15:1.07,20:1.09,25:1.09,30:1.09,35:1.09,40:1.07,45:1.07,50:1.03,55:1.03,60:1,90:.74}};function Qe(t,s){const n=Math.max(-90,Math.min(90,t)),l=Object.keys(ie).map(Number).reduce((c,d)=>Math.abs(d-n)<Math.abs(c-n)?d:c),r=Math.max(0,Math.min(90,s)),o=Object.keys(ie[l]).map(Number).reduce((c,d)=>Math.abs(d-r)<Math.abs(c-r)?d:c);return ie[l][o]}function us(t,s,n,a,l,r=0){const i=we(l),o=Qe(a,n);let c=i*o*t;return c=c*(1-s/100),c=c*(1-r/100),Math.round(c)}async function xs(t){if(!t.adresse.codePostal)throw new Error("Code postal manquant");if(!t.typeCompteur)throw new Error("Type de compteur manquant");const s=t.nombreModules*t.puissanceModules/1e3,n=t.nombreModules*t.surfaceUnitaire;try{const a=t.adresse.codePostal.substring(0,2);return{productionAnnuelle:us(s,t.pertes,t.inclinaison,t.orientation,a,t.masqueSolaire),puissanceCrete:Math.round(s*100)/100,surfaceTotale:Math.round(n*100)/100,typeCompteur:t.typeCompteur}}catch(a){throw console.error("Erreur lors du calcul:",a),new Error("Erreur lors du calcul de la production")}}const Le={monophase:6,triphase:9};function et(t){return t==="monophase"?Le.monophase:Le.triphase}const hs={LOAD_SHIFTING:1.05,PEAK_HOURS:{SUMMER:{start:11,end:16},WINTER:{start:12,end:15}},SHIFTABLE_LOADS:{WASHING_MACHINE:{power:2e3,duration:2},DISHWASHER:{power:1500,duration:1.5},DRYER:{power:2500,duration:1},WATER_HEATER:{power:2e3,duration:2},POOL_PUMP:{power:800,duration:6}}};function ps(t,s){if(!s||!t)return 0;const n=t/s;let a;return n<=.35?a=.95:n<=.45?a=.9:n<=.6?a=.85:a=.75,a*=hs.LOAD_SHIFTING,Math.round(a*100)}function gs(t){return t>=90?"Optimisation maximale : excellente rentabilité grâce au déplacement intelligent des consommations":t>=85?"Très forte rentabilité grâce à une autoconsommation optimisée aux heures solaires":t>=75?"Excellent retour sur investissement avec une consommation adaptée à la production":"Forte rentabilité grâce à une bonne gestion de la consommation"}const fs=.25,bs=.1269;function ys(t,s){const n=t*s/100,a=t-n,l=n*fs,r=a*bs;return{economiesAnnuelles:Math.round(l),reventeAnnuelle:Math.round(r)}}function js(t){const{consommationAnnuelle:s,codePostal:n,typeCompteur:a}=t;if(!s||!n||s<=0)return null;const l=n.substring(0,2),r=we(l),i=6/1e4;let o=s*i;o=Math.max(o,3);const c=et(a),d=Math.min(o,c),x=Math.ceil(d*1e3/500),p=x*500/1e3,h=Math.round(p*r),g=ps(h,s),{economiesAnnuelles:N,reventeAnnuelle:C}=ys(h,g);let w=null;return o>c&&(w=`Une installation plus puissante de ${o.toFixed(1)} kWc maximiserait vos économies. Contactez-nous pour étudier la possibilité de passer en triphasé ou d'installer plusieurs onduleurs.`),{nombreModules:x,puissanceCrete:p,production:h,tauxAutoconsommation:g,economiesAnnuelles:N,reventeAnnuelle:C,avertissement:w}}function te({label:t,name:s,value:n,onChange:a,placeholder:l,disabled:r}){return e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),e.jsx("input",{type:"text",name:s,value:n,onChange:a,placeholder:l,disabled:r,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-100",required:!r})]})}async function vs(t){if(!t||t.length<3)return[];try{const s=t.trim(),n=new AbortController,a=setTimeout(()=>n.abort(),1e4),l=await fetch(`https://api-adresse.data.gouv.fr/search/?q=${encodeURIComponent(s)}&limit=5&autocomplete=1`,{signal:n.signal,headers:{Accept:"application/json","User-Agent":"Simulateur Solaire/1.0"}});if(clearTimeout(a),!l.ok)throw new Error(`Erreur HTTP: ${l.status}`);const r=await l.json();if(!Array.isArray(r.features))throw new Error("Format de réponse invalide");return r.features.filter(i=>i.properties.type==="housenumber"||i.properties.type==="street")}catch(s){if(s instanceof Error){if(s.name==="AbortError")return console.error("Timeout de la requête API adresse"),[];console.error("Erreur API adresse:",s.message)}else console.error("Erreur API adresse inconnue");return[]}}function Ns({value:t,onChange:s,onSelect:n}){const[a,l]=u.useState([]),[r,i]=u.useState(!1),[o,c]=u.useState(!1),[d,x]=u.useState(null),[p,h]=u.useState(!1),g=u.useRef(null),N=u.useRef();u.useEffect(()=>{const y=async()=>{if(!t||t.length<3||p){l([]),x(null);return}c(!0),x(null);try{const j=await vs(t);l(j),i(!0)}catch{x("Impossible de récupérer les suggestions. Veuillez réessayer."),l([])}finally{c(!1)}};return N.current&&clearTimeout(N.current),N.current=setTimeout(y,300),()=>{N.current&&clearTimeout(N.current)}},[t,p]),u.useEffect(()=>{const y=j=>{g.current&&!g.current.contains(j.target)&&i(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]);const C=y=>{h(!1),x(null);const j=y.target.value||"";s(j)},w=y=>{const{properties:j,geometry:P}=y,f={lat:P.coordinates[1],lon:P.coordinates[0]},k=j.housenumber?`${j.housenumber} ${j.street}`:j.street;h(!0),s(k),n(k,j.postcode,j.city,f),i(!1),l([])};return e.jsxs("div",{ref:g,className:"relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:t||"",onChange:C,onFocus:()=>!p&&i(!0),placeholder:"Entrez votre adresse...",className:`w-full pl-10 pr-4 py-2 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 ${d?"border-red-300":"border-gray-300"}`}),e.jsx(Xe,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"}),o&&e.jsx("div",{className:"absolute right-3 top-2.5",children:e.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-blue-500 rounded-full border-t-transparent"})})]}),d&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d}),r&&a.length>0&&e.jsx("ul",{className:"absolute z-10 w-full mt-1 bg-white shadow-lg max-h-60 rounded-md py-1 text-base overflow-auto focus:outline-none sm:text-sm",children:a.map(y=>e.jsx("li",{onClick:()=>w(y),className:"cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-blue-50",children:e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"font-normal block truncate",children:y.properties.label})})},y.properties.id))})]})}const ws={"01":"Auvergne-Rhône-Alpes","03":"Auvergne-Rhône-Alpes","07":"Auvergne-Rhône-Alpes",15:"Auvergne-Rhône-Alpes",26:"Auvergne-Rhône-Alpes",38:"Auvergne-Rhône-Alpes",42:"Auvergne-Rhône-Alpes",43:"Auvergne-Rhône-Alpes",63:"Auvergne-Rhône-Alpes",69:"Auvergne-Rhône-Alpes",73:"Auvergne-Rhône-Alpes",74:"Auvergne-Rhône-Alpes",21:"Bourgogne-Franche-Comté",25:"Bourgogne-Franche-Comté",39:"Bourgogne-Franche-Comté",58:"Bourgogne-Franche-Comté",70:"Bourgogne-Franche-Comté",71:"Bourgogne-Franche-Comté",89:"Bourgogne-Franche-Comté",90:"Bourgogne-Franche-Comté",22:"Bretagne",29:"Bretagne",35:"Bretagne",56:"Bretagne",18:"Centre-Val de Loire",28:"Centre-Val de Loire",36:"Centre-Val de Loire",37:"Centre-Val de Loire",41:"Centre-Val de Loire",45:"Centre-Val de Loire","2A":"Corse","2B":"Corse","08":"Grand Est",10:"Grand Est",51:"Grand Est",52:"Grand Est",54:"Grand Est",55:"Grand Est",57:"Grand Est",67:"Grand Est",68:"Grand Est",88:"Grand Est","02":"Hauts-de-France",59:"Hauts-de-France",60:"Hauts-de-France",62:"Hauts-de-France",80:"Hauts-de-France",75:"Île-de-France",77:"Île-de-France",78:"Île-de-France",91:"Île-de-France",92:"Île-de-France",93:"Île-de-France",94:"Île-de-France",95:"Île-de-France",14:"Normandie",27:"Normandie",50:"Normandie",61:"Normandie",76:"Normandie",16:"Nouvelle-Aquitaine",17:"Nouvelle-Aquitaine",19:"Nouvelle-Aquitaine",23:"Nouvelle-Aquitaine",24:"Nouvelle-Aquitaine",33:"Nouvelle-Aquitaine",40:"Nouvelle-Aquitaine",47:"Nouvelle-Aquitaine",64:"Nouvelle-Aquitaine",79:"Nouvelle-Aquitaine",86:"Nouvelle-Aquitaine",87:"Nouvelle-Aquitaine","09":"Occitanie",11:"Occitanie",12:"Occitanie",30:"Occitanie",31:"Occitanie",32:"Occitanie",34:"Occitanie",46:"Occitanie",48:"Occitanie",65:"Occitanie",66:"Occitanie",81:"Occitanie",82:"Occitanie",44:"Pays de la Loire",49:"Pays de la Loire",53:"Pays de la Loire",72:"Pays de la Loire",85:"Pays de la Loire","04":"Provence-Alpes-Côte d'Azur","05":"Provence-Alpes-Côte d'Azur","06":"Provence-Alpes-Côte d'Azur",13:"Provence-Alpes-Côte d'Azur",83:"Provence-Alpes-Côte d'Azur",84:"Provence-Alpes-Côte d'Azur"};function _e(t){const s=t.substring(0,2);return ws[s]||""}function ks({address:t,onChange:s}){u.useEffect(()=>{if(t.codePostal&&!t.region){const a=_e(t.codePostal);a&&s("region",a)}},[t.codePostal,t.region,s]);const n=(a,l,r,i)=>{s("rue",""),s("codePostal",""),s("ville",""),s("region",""),s("rue",a||""),s("codePostal",l||""),s("ville",r||""),s("coordinates",i);const o=_e(l);o&&s("region",o)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Rechercher votre adresse"}),e.jsx(Ns,{value:t.rue||"",onChange:a=>s("rue",a),onSelect:n})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(te,{label:"Code postal",name:"codePostal",value:t.codePostal||"",onChange:a=>s("codePostal",a.target.value),placeholder:"75001",disabled:!0}),e.jsx(te,{label:"Ville",name:"ville",value:t.ville||"",onChange:a=>s("ville",a.target.value),placeholder:"Paris",disabled:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(te,{label:"Région",name:"region",value:t.region||"",onChange:a=>s("region",a.target.value),disabled:!0}),e.jsx(te,{label:"Pays",name:"pays",value:t.pays||"France",onChange:a=>s("pays",a.target.value),disabled:!0})]})]})}const Oe={nombreModules:6,surfaceUnitaire:2.3,inclinaison:30,orientation:0,puissanceModules:500,pertes:14,masqueSolaire:0,typeCompteur:"monophase",consommationAnnuelle:1e4,microOnduleurs:!1,bifacial:!1,adresse:{rue:"",codePostal:"",ville:"",pays:"France"}},Ss=[{value:"monophase",label:"Monophasé (limité à 6 kWc)"},{value:"triphase",label:"Triphasé"}];function G({label:t,name:s,value:n,onChange:a,options:l,unit:r}){return e.jsxs("div",{children:[e.jsxs("label",{htmlFor:s,className:"block text-sm font-medium text-gray-700 mb-1",children:[t," ",r&&e.jsxs("span",{className:"text-gray-500",children:["(",r,")"]})]}),e.jsx("select",{id:s,name:s,value:n,onChange:a,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:l.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]})}function O({label:t,name:s,value:n,onChange:a,min:l,max:r,step:i=1,unit:o,disabled:c=!1}){const d=Number.isFinite(n)?n:"";return e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t," ",o&&e.jsxs("span",{className:"text-gray-500",children:["(",o,")"]})]}),e.jsx("input",{type:"number",name:s,value:d,onChange:a,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-100",min:l,max:r,step:i,disabled:c,required:!c})]})}function Cs({value:t,onChange:s,label:n="Consommation annuelle estimée"}){const a=()=>{H()};return e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{label:n,name:"consommationAnnuelle",value:t,onChange:s,min:0,max:1e5,step:100,unit:"kWh/an"}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Vous trouverez votre consommation annuelle sur votre facture d'électricité."}),e.jsxs($,{to:"/abie-link",onClick:a,className:"relative block bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl border border-blue-200 hover:border-blue-300 transition-colors group overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0",children:e.jsx("div",{className:"bg-amber-500 text-white text-xs px-3 py-1 rounded-bl-xl font-medium transform rotate-0",children:"Bientôt disponible"})}),e.jsxs("div",{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 p-2.5 bg-blue-100 rounded-lg group-hover:bg-blue-200 transition-colors",children:e.jsx(Ne,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-blue-600",children:"Connecter mon compteur Linky"}),e.jsx("span",{className:"text-xs px-2 py-0.5 bg-white/80 text-blue-600 rounded-full border border-blue-200",children:"Optionnel"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:"Récupérez automatiquement vos données de consommation"})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"p-2 rounded-full group-hover:bg-blue-200/50 transition-colors",children:e.jsx(ae,{className:"h-5 w-5 text-blue-400 group-hover:text-blue-600 transition-colors"})})})]})]})]})]})}function Ps({typeCompteur:t,consommationAnnuelle:s,onTypeCompteurChange:n,onConsommationChange:a}){return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Dimensionnement"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(G,{label:"Type de compteur",name:"typeCompteur",value:t,onChange:n,options:Ss}),e.jsx(Cs,{value:s,onChange:a})]})]})}function A(t){return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR",minimumFractionDigits:2,maximumFractionDigits:2,useGrouping:!1}).format(t)}function As({recommendation:t,consommationAnnuelle:s,departement:n}){if(!t||!s)return null;const a=Math.round(t.production/s*100),l=t.economiesAnnuelles+t.reventeAnnuelle;return e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 p-6 rounded-lg shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(Kt,{className:"h-7 w-7 text-blue-500"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Solution photovoltaïque recommandée"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(K,{className:"h-5 w-5 text-amber-500"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Votre installation"})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[t.puissanceCrete.toFixed(2)," kWc"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[t.nombreModules," panneaux haute performance de 500W"]})]}),e.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Bt,{className:"h-5 w-5 text-green-500"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Production solaire"})]}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[t.production.toLocaleString()," kWh/an"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a,"% de votre consommation actuelle"]})]}),e.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Rt,{className:"h-5 w-5 text-blue-500"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Autonomie énergétique"})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[t.tauxAutoconsommation,"%"]}),e.jsx("p",{className:"text-gray-600",children:"d'autoconsommation"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:gs(t.tauxAutoconsommation)})]}),e.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Ze,{className:"h-5 w-5 text-emerald-500"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Économies 1ère année"})]}),e.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:[A(l),"/an"]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-2 space-y-1",children:[e.jsxs("p",{children:["• Économies : ",A(t.economiesAnnuelles),"/an"]}),e.jsxs("p",{children:["• Revente : ",A(t.reventeAnnuelle),"/an"]})]})]})]}),t.avertissement?e.jsxs("div",{className:"mt-6 p-4 bg-amber-50 border border-amber-200 rounded-lg flex items-start gap-3",children:[e.jsx(Ge,{className:"h-5 w-5 text-amber-500 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-amber-800",children:t.avertissement})]}):e.jsx("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-800",children:"Cette installation est parfaitement dimensionnée pour maximiser vos économies tout en optimisant votre investissement. Vous bénéficierez d'excellentes performances et d'un retour sur investissement optimal."})})]})}function Y({content:t}){const[s,n]=u.useState(!1);return e.jsxs("div",{className:"relative inline-block",children:[e.jsx(W,{className:"h-4 w-4 text-gray-400 hover:text-gray-600 cursor-help inline-block ml-1",onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1)}),s&&e.jsxs("div",{className:"absolute z-10 w-72 px-4 py-3 text-sm bg-gray-900 text-white rounded-lg shadow-lg left-1/2 -translate-x-1/2 top-6",children:[e.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-gray-900 rotate-45"}),t]})]})}function ue({label:t,unit:s,tooltipContent:n,...a}){return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[t," ",s&&e.jsxs("span",{className:"text-gray-500",children:["(",s,")"]})]}),e.jsx(Y,{content:n})]}),e.jsx(O,{label:"",...a,className:"mt-0"})]})}function Ms({value:t,onChange:s,typeCompteur:n}){const{settings:a}=re(),l=a.installationPrices.map(d=>d.power).sort((d,x)=>d-x),r=et(n),i=l.filter(d=>d<=r),o=l.filter(d=>d>9),c=[...i,...o].map(d=>({value:d,label:`${d.toFixed(1)} kWc${d>9?" (Pro)":""}`}));return e.jsxs("div",{className:"space-y-2",children:[e.jsx(G,{label:"Puissance de l'installation",name:"puissanceCrete",value:t,onChange:d=>s(parseFloat(d.target.value)),options:c,unit:"kWc"}),n==="monophase"&&t<=9&&e.jsx("p",{className:"text-sm text-gray-500",children:"Limité à 6 kWc en monophasé"}),t>9&&e.jsx("p",{className:"text-sm text-amber-500",children:"Installation professionnelle - Paiement comptant uniquement"})]})}const tt=[{value:-90,label:"EST"},{value:-45,label:"SUD-EST"},{value:0,label:"SUD"},{value:45,label:"SUD-OUEST"},{value:90,label:"OUEST"}],Es=Array.from({length:19},(t,s)=>({value:s*5,label:`${s*5}°`}));function st(t){const s=tt.find(n=>n.value===t);return s?s.label:`${t}°`}const Is=[{value:0,label:"Aucun ombrage (0% de pertes)"},{value:5,label:"Ombrage léger - arbres éloignés (5% de pertes)"},{value:10,label:"Ombrage modéré - quelques arbres proches (10% de pertes)"},{value:15,label:"Ombrage important - bâtiments voisins (15% de pertes)"},{value:20,label:"Ombrage très important - environnement dense (20% de pertes)"}];function Rs({orientation:t,inclinaison:s}){const n=Qe(t,s);return e.jsxs("div",{className:"bg-gray-50 p-4 rounded-md",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Coefficient inclinaison/orientation"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.toFixed(2)}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:n>=1.1?"Excellent":n>=1?"Très bon":n>=.9?"Bon":n>=.8?"Acceptable":"Sous-optimal"})]})}function Fs({params:t,onChange:s,onSelectChange:n,onParamsChange:a}){const l=o=>{const c=Math.ceil(o*1e3/t.puissanceModules);a({nombreModules:c})},r=o=>()=>{a({[o]:!t[o]})},i=o=>()=>{const c={microinverter:"https://drive.google.com/file/d/1eHC5DfxUCI9eGWikzXL2Adee7mmUS_EL/view?usp=drive_link",bifacial:"https://drive.google.com/file/d/159O_va1W0Y2NBpUiJw-tt-wIQAgIq02l/view"};window.open(c[o],"_blank")};return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Installation"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(Ms,{value:t.nombreModules*t.puissanceModules/1e3,onChange:l,typeCompteur:t.typeCompteur}),e.jsx(O,{label:"Nombre de modules",name:"nombreModules",value:t.nombreModules,onChange:s,min:1,max:100,disabled:!0}),e.jsx(G,{label:"Inclinaison",name:"inclinaison",value:t.inclinaison,onChange:n,options:Es,unit:"°"}),e.jsx(G,{label:"Orientation",name:"orientation",value:t.orientation,onChange:n,options:tt}),e.jsx(ue,{label:"Pertes système",name:"pertes",value:t.pertes,onChange:s,min:0,max:100,unit:"%",tooltipContent:"Les pertes système incluent les pertes dues aux câbles électriques, à la conversion DC/AC par l'onduleur, aux salissures sur les panneaux, et aux variations de température."}),e.jsx(G,{label:"Masque solaire",name:"masqueSolaire",value:t.masqueSolaire,onChange:n,options:Is}),e.jsx("div",{className:"md:col-span-2 space-y-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-6",children:[e.jsxs("div",{className:"flex-1 bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Micro-onduleurs"}),e.jsx(Y,{content:"Les micro-onduleurs optimisent la production de chaque panneau individuellement et augmentent la fiabilité du système"})]}),e.jsx("button",{type:"button",role:"switch","aria-checked":t.microOnduleurs||!1,onClick:r("microOnduleurs"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-300 focus:ring-offset-2 ${t.microOnduleurs?"bg-blue-400":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.microOnduleurs?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("button",{onClick:i("microinverter"),className:"mt-2 text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[e.jsx(z,{className:"h-4 w-4"}),"Fiche technique"]})]}),e.jsxs("div",{className:"flex-1 bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Technologie bifacial"}),e.jsx(Y,{content:"Les panneaux bifaciaux captent la lumière des deux côtés, augmentant la production jusqu'à 10% selon les conditions d'installation"})]}),e.jsx("button",{type:"button",role:"switch","aria-checked":t.bifacial||!1,onClick:r("bifacial"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-300 focus:ring-offset-2 ${t.bifacial?"bg-blue-400":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.bifacial?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("button",{onClick:i("bifacial"),className:"mt-2 text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[e.jsx(z,{className:"h-4 w-4"}),"Fiche technique"]})]})]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Rs,{orientation:t.orientation,inclinaison:t.inclinaison})})]})]})}function at({result:t,onModifyPower:s}){return e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Résultats estimés"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Production annuelle"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[t.productionAnnuelle.toLocaleString()," kWh/an"]})]}),e.jsxs("div",{className:"relative bg-blue-50 p-4 rounded-lg group",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Puissance crête"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[t.puissanceCrete.toFixed(1)," kWc"]}),s&&e.jsx("button",{onClick:s,className:"text-sm text-blue-600 hover:text-blue-800 opacity-0 group-hover:opacity-100 transition-opacity",children:"Modifier"})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Surface totale"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[t.surfaceTotale.toFixed(1)," m²"]})]})]})]})}function Ts({onReset:t,canProceed:s,result:n}){const a=V(),l=J(),{clientInfo:r}=D(),i=!!(r.civilite&&r.nom&&r.prenom&&r.telephone&&r.email),o=()=>{if(!i){alert("Veuillez remplir tous les champs obligatoires avant de continuer.");return}if(!n){alert("Veuillez attendre la fin du calcul avant de continuer.");return}const c=l.state||{};a("/projection",{state:{...c,productionAnnuelle:n.productionAnnuelle,puissanceCrete:n.puissanceCrete,surfaceTotale:n.surfaceTotale}}),H()};return e.jsxs("div",{className:"flex justify-between items-center mt-8 pt-4 border-t border-gray-200",children:[e.jsxs("button",{type:"button",onClick:t,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Réinitialiser"]}),e.jsxs("button",{type:"button",disabled:!s||!i,onClick:o,className:`inline-flex items-center px-6 py-2 shadow-sm text-sm font-medium rounded-md text-white transition-colors
          ${s&&i?"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500":"bg-gray-300 cursor-not-allowed"}`,children:["Continuer",e.jsx(fe,{className:"h-4 w-4 ml-2"})]})]})}function Ds({codePostal:t}){if(!t)return null;const s=t.substring(0,2),n=we(s);return e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-yellow-50 p-4 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(K,{className:"h-6 w-6 text-yellow-500"}),e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Ensoleillement de votre région",e.jsx(Y,{content:"Données issues de PVGIS (Photovoltaic Geographical Information System) de la Commission Européenne. L'ensoleillement est mesuré sur une surface horizontale en kWh/m²/an."})]})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600",children:n.toLocaleString()}),e.jsx("span",{className:"text-gray-600",children:"kWh/m²/an"})]}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:n>=1500?"Excellent potentiel solaire":n>=1300?"Très bon potentiel solaire":n>=1100?"Bon potentiel solaire":"Potentiel solaire modéré"})]})}function nt(){const[t,s]=u.useState(()=>{const r=localStorage.getItem("solarParams");if(r){const i=JSON.parse(r);return i.orientation=Number(i.orientation),i}return Oe}),[n,a]=u.useState(()=>{const r=localStorage.getItem("solarResult");return r?JSON.parse(r):null});return u.useEffect(()=>{localStorage.setItem("solarParams",JSON.stringify(t)),localStorage.setItem("orientation",t.orientation.toString()),localStorage.setItem("orientationLabel",st(t.orientation))},[t]),u.useEffect(()=>{n&&localStorage.setItem("solarResult",JSON.stringify(n))},[n]),{params:t,setParams:s,result:n,setResult:a,resetData:()=>{s(Oe),a(null),localStorage.removeItem("solarParams"),localStorage.removeItem("solarResult"),localStorage.removeItem("orientation"),localStorage.removeItem("orientationLabel")}}}function Ls(){V();const{clientInfo:t,updateClientInfo:s,address:n,updateAddress:a,resetClientInfo:l}=D(),{params:r,setParams:i,result:o,setResult:c,resetData:d}=nt(),[x,p]=u.useState(!1),[h,g]=u.useState(null);u.useEffect(()=>{const f=setTimeout(async()=>{if(!r.adresse.codePostal||!r.consommationAnnuelle){c(null);return}p(!0),g(null);try{const k=await xs(r),m=js({consommationAnnuelle:r.consommationAnnuelle,codePostal:r.adresse.codePostal,typeCompteur:r.typeCompteur});c({...k,recommandation:m}),localStorage.setItem("solarResults",JSON.stringify(k))}catch(k){console.error("Erreur de calcul:",k),g(k instanceof Error?k.message:"Erreur de calcul"),c(null)}finally{p(!1)}},500);return()=>clearTimeout(f)},[r,c]);const N=()=>{l(),d(),c(null),p(!1),g(null)},C=P=>{const{name:f,value:k}=P.target,m=parseFloat(k);Number.isNaN(m)||i(S=>({...S,[f]:m}))},w=P=>{const{name:f,value:k}=P.target;i(m=>({...m,[f]:k}))},y=P=>{const{name:f,value:k}=P.target;s({[f]:k})},j=(P,f)=>{a({[P]:f}),i(k=>({...k,adresse:{...k.adresse,[P]:f}}))};return e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Estimez votre production d'énergie solaire"}),e.jsx("p",{className:"text-gray-600",children:"Calculez le potentiel de production d'énergie solaire de votre installation en fonction de vos paramètres spécifiques."})]}),e.jsxs("form",{onSubmit:P=>P.preventDefault(),className:"space-y-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Informations personnelles"}),e.jsxs("div",{className:"relative group",children:[e.jsx("button",{type:"button",onClick:N,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:e.jsx(je,{className:"h-5 w-5"})}),e.jsx("div",{className:"absolute right-0 top-full mt-2 px-2 py-1 bg-gray-900 text-white text-sm rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap",children:"Réinitialiser"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Civilité"}),e.jsxs("select",{name:"civilite",value:t.civilite,onChange:y,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Sélectionner"}),e.jsx("option",{value:"M",children:"Monsieur"}),e.jsx("option",{value:"Mme",children:"Madame"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nom"}),e.jsx("input",{type:"text",name:"nom",value:t.nom,onChange:y,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prénom"}),e.jsx("input",{type:"text",name:"prenom",value:t.prenom,onChange:y,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Téléphone"}),e.jsx("input",{type:"tel",name:"telephone",value:t.telephone,onChange:y,placeholder:"06 12 34 56 78",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:y,placeholder:"exemple@email.com",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})]})]}),e.jsx(ks,{address:r.adresse,onChange:j}),r.adresse.codePostal&&e.jsx(Ds,{codePostal:r.adresse.codePostal}),e.jsx(Ps,{typeCompteur:r.typeCompteur,consommationAnnuelle:r.consommationAnnuelle,onTypeCompteurChange:w,onConsommationChange:C}),(o==null?void 0:o.recommandation)&&e.jsx(As,{recommendation:o.recommandation,consommationAnnuelle:r.consommationAnnuelle,departement:r.adresse.codePostal.substring(0,2)}),e.jsx(Fs,{params:r,onChange:C,onSelectChange:w,onParamsChange:P=>i(f=>({...f,...P}))}),x?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"inline-block animate-spin h-8 w-8 border-4 border-blue-500 rounded-full border-t-transparent"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Calcul en cours..."})]}):h?e.jsx("div",{className:"bg-red-50 p-4 rounded-md text-red-800",children:h}):o&&e.jsx(at,{result:o}),e.jsx(Ts,{onReset:N,canProceed:!!o&&!x&&!h,result:o})]})]})}const _s={25:{2.5:49,3:59,3.5:68.5,4:78,4.5:87,5:96,5.5:105.5,6:115,6.5:124,7:132,7.5:140,8:149,8.5:158,9:167},20:{2.5:51.6,3:63.6,3.5:72,4:82.8,4.5:92,5:100.8,5.5:111.6,6:120,6.5:129.6,7:138,7.5:146.4,8:156,8.5:164.4,9:174},15:{2.5:56.4,3:73.2,3.5:80.4,4:91.2,4.5:102,5:111.6,5.5:122.4,6:130.8,6.5:142.8,7:150,7.5:159.6,8:169.2,8.5:177.6,9:189.6},10:{2.5:67.2,3:86.4,3.5:97.2,4:106.8,4.5:120,5:134.4,5.5:144,6:153.6,6.5:165.6,7:174,7.5:178.8,8:192,8.5:200.4,9:206.4}},Os={2.5:6890,3:7890,3.5:8890,4:9890,4.5:10890,5:11890,5.5:12890,6:14890,6.5:15890,7:16890,7.5:17890,8:18890,8.5:19890,9:19890};function ke(t){var n;const s=Math.round(t*2)/2;if(s<=9)return Os[s]||0;try{const a=localStorage.getItem("installation_prices");if(!a)return 0;const l=JSON.parse(a);if(!Array.isArray(l))return console.error("Format de prix invalide dans le localStorage"),0;const r=l.find(o=>Math.abs(o.power-s)<.01);if(r!=null&&r.price)return r.price;const i=l.sort((o,c)=>Math.abs(o.power-s)-Math.abs(c.power-s));return(n=i[0])!=null&&n.price?(console.log(`Utilisation du prix le plus proche : ${i[0].power} kWc pour ${s} kWc`),i[0].price):0}catch(a){return console.error("Erreur lors de la lecture des prix:",a),0}}function xe(t,s){var a;const n=Math.round(t*2)/2;return((a=_s[s.toString()])==null?void 0:a[n])||0}function zs(t){return t<=3?Math.round(t*1e3*.22):t<=9?Math.round(t*1e3*.16):t<=36?Math.round(t*1e3*.11):t<=100?Math.round(t*1e3*.08):0}function rt(t,s,n){const a=ke(t);if(a===0)return console.error(`Impossible de trouver un prix pour la puissance ${t} kWc`),0;const l=zs(t),r=Math.round(a*n/100);return a-l-r}function Hs({selectedMode:t,onModeChange:s,puissanceCrete:n,dureeAbonnement:a,onDureeChange:l,onKitSelect:r}){const i=xe(n,a),[o,c]=u.useState(""),[d,x]=u.useState(null),[p,h]=u.useState([]),[g,N]=u.useState(null),C=n>9;u.useEffect(()=>{C&&t==="subscription"&&s("cash")},[C,t,s]),u.useEffect(()=>{const m=localStorage.getItem("revenuFiscal");m&&(c(m),j(parseInt(m,10)))},[i]);const w=m=>{const S=[25,20,15,10],M=[2.5,3,3.5,4,4.5,5,5.5,6],v=[];for(const E of M)for(const R of S){const F=xe(E,R),Z=F*12/m*100;Z<=4&&v.push({power:E,duration:R,monthlyPayment:F,annualRatio:Z})}return v.sort((E,R)=>R.power-E.power)},y=m=>{if(m<=0)return null;const S=i*12,M=Math.ceil(S/.04);return m>=M},j=m=>{if(m>0&&t==="subscription"){const S=y(m);if(x(S),S)h([]);else{const M=w(m);h(M)}}else x(null),h([])},P=m=>{const S=m.target.value.replace(/\D/g,"");if(c(S),S){localStorage.setItem("revenuFiscal",S);const M=parseInt(S,10);j(M)}else localStorage.removeItem("revenuFiscal"),x(null),h([]);N(null)},f=m=>{N(m)},k=()=>{g&&r&&(x(!0),r(g))};return u.useEffect(()=>{t==="cash"&&(c(""),x(null),h([]),N(null),localStorage.removeItem("revenuFiscal"))},[t]),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Mode de financement"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{role:"button",tabIndex:0,onClick:()=>s("cash"),onKeyPress:m=>m.key==="Enter"&&s("cash"),className:`relative p-6 rounded-lg border-2 text-left transition-colors cursor-pointer
            ${t==="cash"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Ye,{className:`h-5 w-5 ${t==="cash"?"text-blue-500":"text-gray-400"}`}),e.jsx("span",{className:"font-medium",children:"Paiement comptant"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Investissez une fois et profitez d'économies maximales dès le premier jour"})]}),e.jsxs("div",{role:"button",tabIndex:0,onClick:()=>!C&&s("subscription"),onKeyPress:m=>m.key==="Enter"&&!C&&s("subscription"),className:`relative p-6 rounded-lg border-2 text-left transition-colors ${C?"opacity-50 cursor-not-allowed border-gray-200":t==="subscription"?"border-blue-500 bg-blue-50 cursor-pointer":"border-gray-200 hover:border-gray-300 cursor-pointer"}`,children:[C&&e.jsx("div",{className:"absolute inset-0 bg-gray-100 bg-opacity-50 flex items-center justify-center rounded-lg",children:e.jsx("div",{className:"bg-white px-4 py-2 rounded-full text-sm text-gray-600 shadow",children:"Non disponible pour puissance > 9 kWc"})}),e.jsx("div",{className:"absolute -top-2 right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"Plus populaire"}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(ye,{className:`h-5 w-5 ${t==="subscription"?"text-blue-500":"text-gray-400"}`}),e.jsx("span",{className:"font-medium",children:"Abonnement mensuel"})]}),t==="subscription"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[i.toFixed(2)," €"]}),e.jsx("span",{className:"text-gray-500",children:"/mois"})]})}),e.jsx("div",{className:"grid grid-cols-4 gap-2 mb-4",children:[10,15,20,25].map(m=>e.jsxs("div",{role:"button",tabIndex:0,onClick:()=>l(m),onKeyPress:S=>S.key==="Enter"&&l(m),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors cursor-pointer text-center
                      ${a===m?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[m," ans"]},m))}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs($,{to:"/modalites-abonnement",onClick:()=>H(),className:"inline-flex items-center text-blue-600 hover:text-blue-800 font-medium",children:["Voir les avantages de l'abonnement",e.jsx(fe,{className:"h-4 w-4 ml-1"})]}),e.jsx($,{to:"/modalites-sortie",onClick:()=>H(),className:"block text-sm text-blue-600 hover:text-blue-800",children:"Consulter les modalités de sortie"})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-4",children:"Répartissez votre investissement sur la durée et commencez à économiser immédiatement"})]})]}),t==="subscription"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Services inclus dans votre abonnement :"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Maintenance préventive et curative 7j/7"}),e.jsxs("li",{children:["• Garantie pièces et main d'œuvre pendant ",a," ans"]}),e.jsx("li",{children:"• Monitoring et optimisation de performance"}),e.jsx("li",{children:"• Assurance tous risques incluse"}),e.jsx("li",{children:"• Pas d'apport initial"}),e.jsx("li",{children:"• Réponse sous 48h"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Revenu fiscal de référence",e.jsxs("div",{className:"relative inline-block ml-2 group",children:[e.jsx(W,{className:"h-4 w-4 text-gray-400 cursor-help"}),e.jsxs("div",{className:"absolute z-10 invisible group-hover:visible bg-gray-900 text-white text-sm rounded-lg py-2 px-3 w-72 bottom-full left-1/2 -translate-x-1/2 mb-2",children:[e.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-gray-900 rotate-45"}),`Le revenu fiscal de référence se trouve sur votre dernier avis d'imposition, en première page dans le cadre "Vos références".`]})]})]}),e.jsx("input",{type:"text",value:o,onChange:P,placeholder:"Montant en euros",className:`mt-1 block w-full rounded-md shadow-sm focus:ring-2 ${d===!0?"border-green-300 focus:border-green-500 focus:ring-green-500":d===!1?"border-amber-300 focus:border-amber-500 focus:ring-amber-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`}),o&&parseInt(o,10)>0&&e.jsxs(e.Fragment,{children:[d===!0&&e.jsxs("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg flex items-start gap-3",children:[e.jsx(de,{className:"h-5 w-5 text-green-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-green-800",children:[e.jsx("p",{className:"font-medium",children:"Vous êtes éligible à cet abonnement"}),e.jsxs("p",{className:"mt-1",children:["Votre revenu vous permet de souscrire à cette offre en toute sérénité. L'abonnement mensuel de ",A(i),"représente moins de 4% de votre revenu annuel."]})]})]}),d===!1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mt-4 p-4 bg-amber-50 border border-amber-200 rounded-lg flex items-start gap-3",children:[e.jsx(Ge,{className:"h-5 w-5 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-amber-800",children:[e.jsx("p",{className:"font-medium",children:"Kit solaire trop puissant pour votre budget"}),e.jsxs("p",{className:"mt-1",children:["Pour un abonnement mensuel de ",A(i),", votre revenu fiscal doit être d'au moins ",A(Math.ceil(i*12/.04)),". Voici les kits solaires adaptés à votre budget :"]})]})]}),p.length>0&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.slice(0,4).map((m,S)=>e.jsxs("div",{onClick:()=>f(m),className:`bg-white rounded-lg p-4 border transition-all cursor-pointer ${g===m?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300 hover:shadow-md"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ne,{className:`h-5 w-5 ${g===m?"text-blue-500":"text-green-500"}`}),e.jsxs("h4",{className:"font-medium text-gray-900",children:["Kit ",m.power," kWc"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["• Durée : ",m.duration," ans"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["• Mensualité : ",A(m.monthlyPayment)]}),e.jsxs("p",{className:"text-sm text-green-600",children:["• ",m.annualRatio.toFixed(1),"% de votre revenu annuel"]})]})]},`${m.power}-${m.duration}`))}),g&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:k,className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[e.jsx(de,{className:"h-5 w-5"}),"Valider ce kit"]})})]})]})]})]})]})]})}function qs({parameters:t,onParameterChange:s,puissanceCrete:n}){const[a,l]=u.useState(!1),{settings:r}=re(),i=g=>{const{name:N,value:C}=g.target;let w=parseFloat(C);switch(N){case"remiseCommerciale":w=Math.min(Math.max(0,w),10);break;case"revalorisationEnergie":w=Math.min(Math.max(0,w),10);break;case"indexationProduction":w=Math.min(Math.max(-5,w),3);break}s({[N]:w})},o=ke(n),c=o*t.remiseCommerciale/100,d=o-c,x=rt(n,t.primeAutoconsommation,t.remiseCommerciale);let p="",h="";try{if(r.subsidyDate){const g=new Date(r.subsidyDate);isNaN(g.getTime())||(p=new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",year:"numeric"}).format(g))}if(r.sellPriceDate){const g=new Date(r.sellPriceDate);isNaN(g.getTime())||(h=new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",year:"numeric"}).format(g))}}catch(g){console.error("Erreur lors du formatage de la date:",g),p="Date non disponible",h="Date non disponible"}return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Paramètres financiers"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[t.financingMode==="cash"&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("span",{className:"text-gray-700",children:"Prix de base TTC"}),e.jsx("span",{className:"font-semibold",children:A(o)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{label:"Remise commerciale",name:"remiseCommerciale",value:t.remiseCommerciale,onChange:i,min:0,max:10,step:1,unit:"%"}),t.remiseCommerciale>0&&e.jsxs("div",{className:"flex justify-between items-center text-gray-700",children:[e.jsx("span",{children:"Prix TTC remisé"}),e.jsx("span",{className:"font-semibold",children:A(d)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-700",children:"Prime à l'autoconsommation"}),e.jsx(Y,{content:`Prime en vigueur au ${p} pour les installations en autoconsommation avec revente de surplus`,children:e.jsx(se,{className:"h-4 w-4 text-gray-400 cursor-help"})})]}),e.jsx("span",{className:"font-semibold text-green-600",children:A(t.primeAutoconsommation)})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-200 flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700",children:"Prix final TTC"}),e.jsx("span",{className:"text-xl font-bold text-blue-600",children:A(x)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(O,{label:"Prix du kWh",name:"prixKwh",value:t.prixKwh,onChange:i,min:0,max:1,step:.01,unit:"€/kWh"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tarif de revente"}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"h-4 w-4 text-gray-400 cursor-help",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1)}),a&&e.jsxs("div",{className:"absolute z-10 w-72 p-3 bg-gray-900 text-white text-sm rounded-lg -right-2 top-6",children:[e.jsx("div",{className:"absolute -top-1 right-3 w-2 h-2 bg-gray-900 rotate-45"}),e.jsxs("p",{children:["Tarif en vigueur au ",h," pour les installations en autoconsommation avec revente de surplus inférieures à 9kWc"]})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",name:"tarifRevente",value:t.tarifRevente,disabled:!0,className:"mt-1 block w-full rounded-md border-gray-300 bg-gray-100 text-gray-500 shadow-sm focus:border-gray-300 focus:ring-0 cursor-not-allowed disabled:bg-gray-100"}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"€/kWh"})})]})]}),e.jsx(O,{label:"Niveau d'autoconsommation",name:"autoconsommation",value:t.autoconsommation,onChange:i,min:0,max:100,unit:"%"}),e.jsx(O,{label:"Revalorisation annuelle",name:"revalorisationEnergie",value:t.revalorisationEnergie,onChange:i,min:0,max:10,unit:"%"}),e.jsx(ue,{label:"Indexation revente",name:"indexationProduction",value:t.indexationProduction,onChange:i,min:-5,max:3,step:.1,unit:"%",tooltipContent:"Évolution annuelle du tarif de revente de l'électricité"}),e.jsx(ue,{label:"Dégradation panneaux",name:"degradationPanneau",value:t.degradationPanneau,onChange:i,min:-2,max:0,step:.1,unit:"%",tooltipContent:"Dégradation annuelle de la production des panneaux solaires (-0.2% par défaut)"})]})]})]})}function $s({projection:t}){const s=t.projectionAnnuelle[0].coutAbonnement>0,n=t.prixFinal;return e.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Projection financière sur 30 ans"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Année"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Production (kWh)"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Autoconsommation"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revente"}),s&&e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Abonnement"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gain total"}),!s&&e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rendement"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.projectionAnnuelle.map(a=>{const l=s?0:(a.economiesAutoconsommation+a.revenusRevente)/n*100;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.annee}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:Math.round(a.production).toString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-green-600",children:A(a.economiesAutoconsommation)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-blue-600",children:A(a.revenusRevente)}),s&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-red-600",children:a.coutAbonnement>0?A(-a.coutAbonnement):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-medium text-gray-900",children:A(a.gainTotal)}),!s&&e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-medium text-emerald-600",children:[l.toFixed(1),"%"]})]},a.annee)})}),e.jsx("tfoot",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Total"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-medium text-green-600",children:A(t.totalAutoconsommation)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-medium text-blue-600",children:A(t.totalRevente)}),s&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-medium text-red-600",children:A(-t.totalAbonnement)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-medium text-gray-900",children:A(t.totalGains)}),!s&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-medium text-emerald-600",children:"-"})]})})]})})]})}const Ws={"Provence-Alpes-Côte d'Azur":1.2,Occitanie:1.15,"Nouvelle-Aquitaine":1.1,"Auvergne-Rhône-Alpes":1.05,Corse:1.2,"Bourgogne-Franche-Comté":.95,"Centre-Val de Loire":.95,"Grand Est":.9,"Hauts-de-France":.85,"Île-de-France":1.1,Normandie:.9,"Pays de la Loire":1,Bretagne:.95};function Vs({installedPower:t}){const[s,n]=u.useState(!1),{address:a}=D(),l=Math.max(0,t||0),r=a.region&&Ws[a.region]||1,i=l*r,o=Math.min(Math.max(0,i),10);return console.log("Property Value Calculation:",{installedPower:t,baseIncrease:l,region:a.region,regionalCoefficient:r,adjustedIncrease:i,estimatedIncrease:o}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Gt,{className:"h-6 w-6 text-purple-500"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Plus-value immobilière"})]}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:["+",o.toFixed(1),"%"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Valeur verte selon l'ADEME",a.region&&r!==1&&e.jsxs("span",{className:"text-purple-600",children:[" ","• Région ",a.region]})]}),e.jsxs("div",{className:"absolute right-0 top-0 cursor-help",onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:[e.jsx(se,{className:"h-4 w-4 text-gray-400"}),s&&e.jsxs("div",{className:"absolute z-10 w-72 p-3 bg-gray-900 text-white text-sm rounded-lg -right-2 top-6 shadow-xl",children:[e.jsx("div",{className:"absolute -top-1 right-3 w-2 h-2 bg-gray-900 rotate-45"}),e.jsx("p",{className:"mb-2",children:"Estimation basée sur des études nationales (ADEME, notaires) :"}),e.jsxs("ul",{className:"space-y-1 text-gray-300 text-xs",children:[e.jsx("li",{children:"• 1% de plus-value par kWc installé"}),e.jsxs("li",{children:["• Coefficient régional : ",r.toFixed(2)]}),e.jsx("li",{children:"• Varie selon l'attractivité du marché local"}),e.jsx("li",{children:"• Dépend des caractéristiques du bien"}),e.jsx("li",{children:"• Estimation non contractuelle"})]})]})]})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Label HPE (Haute Performance Énergétique)"})]})}function Bs(t){const s=Math.round(t/.2),n=Math.round(t/25),a=(t/1e3).toFixed(1);return`${s.toString()} km en voiture
          ou ${n} arbres plantés
          ou ${a} vols Paris-New York`}function Us({projection:t}){const s=t.projectionAnnuelle.slice(0,20),n=s.reduce((d,x)=>d+x.economiesAutoconsommation,0)/20,a=s.reduce((d,x)=>d+x.revenusRevente,0)/20,l=n+a,r=t.projectionAnnuelle[0].coutAbonnement>0,i=r?null:l/t.prixFinal*100,o=Math.round(t.projectionAnnuelle[0].production*.06),c=t.prixInstallation?Math.round(t.prixInstallation/2500):0;return console.log("ProjectionSummary - puissanceCrete:",{prixInstallation:t.prixInstallation,calculatedPower:c}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 rounded-lg shadow-lg p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Synthèse financière"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Ze,{className:"h-6 w-6 text-green-500"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Revenus moyens annuels (sur 20 ans)"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:A(l)}),e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[e.jsxs("p",{children:["• Économies : ",A(n)]}),e.jsxs("p",{children:["• Revente : ",A(a)]}),!r&&i&&e.jsxs("p",{className:"mt-2 text-emerald-600 font-medium",children:["Rendement moyen : ",i.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(ve,{className:"h-6 w-6 text-blue-500"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Gains totaux sur 30 ans"})]}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:A(t.totalGains)}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Cumul des économies et de la revente"})]}),e.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Je,{className:"h-6 w-6 text-emerald-500"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Impact environnemental"})]}),e.jsxs("p",{className:"text-2xl font-bold text-emerald-600",children:[o.toString()," kg"]}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["CO₂ économisé par an, équivalent à :",Bs(o)]})]}),e.jsx(Vs,{installedPower:t.projectionAnnuelle[0].production/1100})]})]})}function Gs(t,s,n,a){const l=Math.pow(1+t.degradationPanneau/100,s-1),r=Math.pow(1+t.indexationProduction/100,s-1),i=Math.pow(1+t.revalorisationEnergie/100,s-1),o=n*l,c=o*(t.autoconsommation/100),d=o-c,x=t.prixKwh*i,p=s<=20?t.tarifRevente*r:0,h=c*x,g=d*p,N=t.dureeAbonnement||20,C=t.financingMode==="subscription"&&s<=N?xe(a,N)*12:0;return{annee:s,production:o,autoconsommation:c,revente:d,economiesAutoconsommation:h,revenusRevente:g,coutAbonnement:C,gainTotal:h+g-C}}function Ks(t,s,n){const a=[];let l=0,r=0,i=0,o=0;for(let g=1;g<=30;g++){const N=Gs(t,g,s,n);a.push(N),l+=N.economiesAutoconsommation,r+=N.revenusRevente,i+=N.coutAbonnement,o+=N.gainTotal}const c={autoconsommation:l/30,revente:r/30,abonnement:i/30,total:o/30},d=ke(n),x=rt(n,t.primeAutoconsommation,t.remiseCommerciale);let p=0,h=0;for(let g=0;g<a.length;g++)p+=a[g].gainTotal,p>=x&&h===0&&(h=g+1);return{projectionAnnuelle:a,totalAutoconsommation:l,totalRevente:r,totalAbonnement:i,totalGains:o,moyenneAnnuelle:c,anneeRentabilite:h,prixInstallation:d,primeAutoconsommation:t.primeAutoconsommation,remiseCommerciale:t.remiseCommerciale,prixFinal:x}}function lt(){const{settings:t}=re(),[s,n]=u.useState(()=>({financingMode:"subscription",prixKwh:t.baseKwhPrice,tarifRevente:t.baseSellPrice,autoconsommation:t.defaultAutoconsumption,revalorisationEnergie:t.defaultEnergyRevaluation,indexationProduction:t.defaultSellIndexation,degradationPanneau:t.defaultPanelDegradation,dureeAbonnement:20,primeAutoconsommation:0,remiseCommerciale:0})),[a,l]=u.useState(null);u.useEffect(()=>{n(o=>({...o,prixKwh:t.baseKwhPrice,tarifRevente:t.baseSellPrice,autoconsommation:t.defaultAutoconsumption,revalorisationEnergie:t.defaultEnergyRevaluation,indexationProduction:t.defaultSellIndexation,degradationPanneau:t.defaultPanelDegradation}))},[t]),u.useEffect(()=>{const o=c=>{n(d=>({...d,...c.detail}))};return window.addEventListener("financialSettingsUpdated",o),()=>{window.removeEventListener("financialSettingsUpdated",o)}},[]);const r=u.useCallback(o=>{n(c=>({...c,...o}))},[]),i=u.useCallback((o,c)=>{const d=Ks(s,o,c);l(d)},[s]);return{parameters:s,projection:a,updateParameters:r,calculateProjection:i}}function Ys(){const t=V(),s=J(),[n,a]=u.useState(!1),[l,r]=u.useState(!1),[i,o]=u.useState(!1),[c,d]=u.useState(null);D();const{projection:x,parameters:p,updateParameters:h,calculateProjection:g}=lt();u.useEffect(()=>{const f=localStorage.getItem("solarResults");if(!f){t("/");return}(async()=>{var m,S;try{const M=JSON.parse(f);if(!M.typeCompteur){console.error("Type de compteur manquant dans les résultats"),t("/");return}d(M);const{productionAnnuelle:v,puissanceCrete:E}=M,R=((m=s.state)==null?void 0:m.power)||localStorage.getItem("selectedPower"),F=((S=s.state)==null?void 0:S.duration)||localStorage.getItem("subscriptionDuration"),L=R?parseFloat(R):E;if(!v||!L){t("/");return}const Z=L<=3?.22:.16,dt=Math.round(Z*L*1e3);h({productionAnnuelle:v,puissanceCrete:L,primeAutoconsommation:dt,financingMode:"subscription",dureeAbonnement:F?parseInt(F):20}),localStorage.removeItem("selectedPower"),localStorage.removeItem("subscriptionDuration")}catch(M){console.error("Erreur lors du chargement des résultats:",M),t("/")}})()},[t,h,s.state]);const N=async()=>{!p.productionAnnuelle||!p.puissanceCrete||(a(!0),localStorage.setItem("financialMode",p.financingMode),localStorage.setItem("primeAutoconsommation",p.primeAutoconsommation.toString()),localStorage.setItem("remiseCommerciale",p.remiseCommerciale.toString()),p.dureeAbonnement&&localStorage.setItem("subscriptionDuration",p.dureeAbonnement.toString()),await new Promise(f=>setTimeout(f,1e3)),g(p.productionAnnuelle,p.puissanceCrete),r(!0),a(!1))},C=f=>{if(!(c!=null&&c.typeCompteur)){console.error("Type de compteur non défini");return}const k=c.typeCompteur==="monophase"?6:9;if(f>k){console.warn(`Puissance ${f} kWc supérieure à la limite ${k} kWc en ${c.typeCompteur}`);return}const m={...c,puissanceCrete:f,productionAnnuelle:Math.round(f*(c.productionAnnuelle/c.puissanceCrete)),surfaceTotale:Math.round(f*2.3*100)/100};d(m),localStorage.setItem("solarResults",JSON.stringify(m));const S=f<=3?.22:.16,M=Math.round(S*f*1e3);h({puissanceCrete:f,productionAnnuelle:m.productionAnnuelle,primeAutoconsommation:M})},w=f=>{C(f.power),h({dureeAbonnement:f.duration})},y=()=>{H(),t("/eligibilite")};if(!(c!=null&&c.typeCompteur))return null;const j=c.typeCompteur==="monophase"?6:9,P=Array.from({length:Math.floor((j-2.4)/.5)+1},(f,k)=>({value:2.5+k*.5,label:`${(2.5+k*.5).toFixed(1)} kWc`})).filter(f=>f.value<=j);return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs($,{to:"/",className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700",children:[e.jsx(ge,{className:"h-4 w-4 mr-1"}),"Retour au dimensionnement"]})}),e.jsxs("div",{className:"space-y-8",children:[e.jsx(at,{result:c,onModifyPower:()=>o(!0)}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Ajuster la puissance"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Puissance (kWc)"}),e.jsx("select",{value:c.puissanceCrete,onChange:f=>C(parseFloat(f.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:P.map(f=>e.jsx("option",{value:f.value,children:f.label},f.value))}),c.typeCompteur==="monophase"&&e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Limité à 6 kWc en monophasé"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:"Annuler"}),e.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Appliquer"})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx(Hs,{selectedMode:p.financingMode,onModeChange:f=>h({financingMode:f}),puissanceCrete:p.puissanceCrete,dureeAbonnement:p.dureeAbonnement||20,onDureeChange:f=>h({dureeAbonnement:f}),onKitSelect:w}),e.jsx(qs,{parameters:p,onParameterChange:h,puissanceCrete:p.puissanceCrete}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:N,disabled:n,className:"relative px-6 py-3 bg-blue-600 text-white rounded-lg shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed group",children:e.jsx("div",{className:"flex items-center gap-2",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative w-5 h-5",children:e.jsx(K,{className:"absolute inset-0 w-5 h-5 text-yellow-300 animate-spin"})}),e.jsx("span",{children:"Calcul en cours..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"w-5 h-5"}),e.jsx("span",{children:"Calculer la projection financière"})]})})})})]})}),l&&x&&!n&&e.jsxs(e.Fragment,{children:[e.jsx($s,{projection:x}),e.jsx(Us,{projection:x}),e.jsxs("div",{className:"mt-8 space-y-6",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Pour toute demande d'étude d'éligibilité au dossier, nos conseillers sont à votre disposition :"}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Zt,{className:"h-5 w-5 text-blue-600"}),e.jsx("a",{href:"tel:0183835150",className:"text-blue-600 hover:text-blue-800 font-medium",children:"01 83 83 51 50"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Jt,{className:"h-5 w-5 text-blue-600"}),e.jsx("a",{href:"mailto:contact@abie.fr",className:"text-blue-600 hover:text-blue-800 font-medium",children:"contact@abie.fr"})]})]})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:y,className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:["Tester mon éligibilité",e.jsx(fe,{className:"ml-2 -mr-1 h-5 w-5"})]})})]})]})]})]})}const ze=[{icon:ye,title:"Réponse sous 48H",duration:"2 jours",description:"Étude initiale de votre dossier"},{icon:Qt,title:"Étude technique",duration:"15 jours",description:"Analyse détaillée et dimensionnement"},{icon:z,title:"Démarches",duration:"30 jours",description:"Autorisations administratives"},{icon:ls,title:"Installation",duration:"45 jours",description:"Pose et mise en service"},{icon:Yt,title:"Monitoring",duration:"Permanent",description:"Suivi de production et maintenance"}],Js=()=>{V(),D();const[t,s]=u.useState(""),[n,a]=u.useState(null),[l,r]=u.useState(null),[i,o]=u.useState([]),[c,d]=u.useState(null),[x,p]=u.useState(!1),h=y=>{const j=y.target.value.replace(/\D/g,"").slice(0,14);s(j)},g=y=>j=>{var f;const P=(f=j.target.files)==null?void 0:f[0];if(P){if(P.size>10*1024*1024){d("Le fichier est trop volumineux. Taille maximum : 10MB");return}y==="tax"?a(P):r(P),d(null)}},N=y=>{const f=Array.from(y.target.files||[]).filter(k=>k.size>10*1024*1024?(d("Une photo est trop volumineuse. Taille maximum : 10MB"),!1):!0).map(k=>({id:Math.random().toString(36).substr(2,9),file:k}));o(k=>[...k,...f]),d(null)},C=y=>{o(j=>j.filter(P=>P.id!==y))},w=()=>{p(!0)};return e.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs($,{to:"/projection",className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700",children:[e.jsx(ge,{className:"h-4 w-4 mr-1"}),"Retour à la projection financière"]})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Vérification d'éligibilité"}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg mb-8",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Étapes de votre installation"}),e.jsx("div",{className:"relative flex justify-between",children:ze.map((y,j)=>e.jsxs("div",{className:"relative flex flex-col items-center w-32",children:[j<ze.length-1&&e.jsx("div",{className:"absolute w-full h-[2px] top-7 left-[50%] bg-blue-200",style:{width:"calc(200% - 2rem)"}}),e.jsx("div",{className:"relative z-10 flex items-center justify-center w-14 h-14 bg-white rounded-full border-2 border-blue-500",children:e.jsx(y.icon,{className:"h-6 w-6 text-blue-500"})}),e.jsxs("div",{className:"mt-3 text-center",children:[e.jsx("span",{className:"inline-block px-3 py-1 bg-blue-50 text-blue-700 text-sm font-medium rounded-full mb-2",children:y.duration}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:y.title}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:y.description})]})]},j))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Numéro PDL (Point De Livraison)",e.jsxs("div",{className:"relative inline-block ml-2 group",children:[e.jsx(W,{className:"h-4 w-4 text-gray-400 cursor-help"}),e.jsxs("div",{className:"absolute z-10 invisible group-hover:visible bg-gray-900 text-white text-sm rounded-lg py-2 px-3 w-72 bottom-full left-1/2 -translate-x-1/2 mb-2",children:[e.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-gray-900 rotate-45"}),"Le numéro PDL (Point De Livraison) est un identifiant unique de 14 chiffres qui se trouve sur votre facture d'électricité et sur votre compteur Linky."]})]})]}),e.jsx("input",{type:"text",value:t,onChange:h,placeholder:"14 chiffres",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",maxLength:14})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Avis d'imposition"}),e.jsxs("div",{className:`relative flex items-center justify-center p-6 border-2 border-dashed rounded-lg transition-colors ${n?"border-green-300 bg-green-50":"border-gray-300 hover:border-blue-500 bg-gray-50"}`,children:[e.jsx("input",{type:"file",className:"hidden",accept:".pdf,.jpg,.jpeg,.png",onChange:g("tax"),id:"tax-file"}),e.jsx("label",{htmlFor:"tax-file",className:"cursor-pointer text-center",children:n?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{className:"text-green-700",children:n.name})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(Te,{className:"h-8 w-8 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"Cliquez pour sélectionner votre avis d'imposition"})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pièce d'identité"}),e.jsxs("div",{className:`relative flex items-center justify-center p-6 border-2 border-dashed rounded-lg transition-colors ${l?"border-green-300 bg-green-50":"border-gray-300 hover:border-blue-500 bg-gray-50"}`,children:[e.jsx("input",{type:"file",className:"hidden",accept:".pdf,.jpg,.jpeg,.png",onChange:g("id"),id:"id-file"}),e.jsx("label",{htmlFor:"id-file",className:"cursor-pointer text-center",children:l?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{className:"text-green-700",children:l.name})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(Te,{className:"h-8 w-8 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"Cliquez pour sélectionner votre pièce d'identité"})]})})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Photos de l'environnement",e.jsxs("div",{className:"relative inline-block ml-2 group",children:[e.jsx(W,{className:"h-4 w-4 text-gray-400 cursor-help"}),e.jsxs("div",{className:"absolute z-10 invisible group-hover:visible bg-gray-900 text-white text-sm rounded-lg py-2 px-3 w-80 bottom-full left-1/2 -translate-x-1/2 mb-2",children:[e.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-gray-900 rotate-45"}),"Nous avons besoin de photos de : • Votre toit à équiper • L'environnement proche (arbres, bâtiments) • Les éventuels masques solaires (ombres portées)"]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:i.map(y=>e.jsx("div",{className:"relative bg-gray-50 p-3 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Dt,{className:"h-5 w-5 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600 truncate",children:y.file.name})]}),e.jsx("button",{type:"button",onClick:()=>C(y.id),className:"p-1 hover:bg-gray-200 rounded-full transition-colors",children:e.jsx(is,{className:"h-4 w-4 text-gray-500"})})]})},y.id))}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("label",{className:"relative cursor-pointer",children:[e.jsx("input",{type:"file",className:"hidden",accept:"image/*",multiple:!0,onChange:N}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[e.jsx(Xt,{className:"h-5 w-5 text-gray-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Ajouter des photos"})]})]})})]})]}),c&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:e.jsx("div",{className:"text-sm text-red-600",children:c})}),e.jsx("div",{className:"flex justify-center mt-8",children:e.jsx("button",{onClick:w,className:"px-6 py-3 bg-blue-600 text-white rounded-lg shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:"Valider mon dossier"})}),e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg mt-8",children:[e.jsx("h4",{className:"text-lg font-medium text-blue-900 mb-4",children:"Besoin d'assistance ?"}),e.jsx("div",{className:"text-blue-700 mb-4",children:"Nos conseillers sont à votre disposition pour vous accompagner dans votre projet d'installation solaire."}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-blue-800",children:[e.jsx("span",{className:"font-medium",children:"Téléphone :"})," ",e.jsxs("span",{className:"relative group",children:[e.jsx("a",{href:"tel:0183835150",className:"hover:underline",children:"01 83 83 51 50"}),e.jsxs("div",{className:"absolute z-10 invisible group-hover:visible bg-gray-900 text-white text-sm rounded-lg py-2 px-3 w-64 bottom-full left-1/2 -translate-x-1/2 mb-2",children:[e.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-gray-900 rotate-45"}),e.jsxs("div",{className:"text-center",children:["Horaires d'ouverture :",e.jsx("br",{}),"Du lundi au vendredi",e.jsx("br",{}),"9H30 - 18H00"]})]})]})]}),e.jsxs("div",{className:"text-blue-800",children:[e.jsx("span",{className:"font-medium",children:"Email :"})," ",e.jsx("a",{href:"mailto:contact@abie.fr",className:"hover:underline",children:"contact@abie.fr"})]})]})]})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full overflow-hidden shadow-xl",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-1/2",children:e.jsx("img",{src:"https://i.ibb.co/GQr7gmd/maison-panneaux-solaires-toit.jpg",alt:"Maison avec panneaux solaires",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"w-1/2 p-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Félicitations !"}),e.jsx("div",{className:"text-gray-600 mb-4",children:"Bienvenue dans le monde de demain ! Vous venez de faire le premier pas vers une énergie plus propre et plus économique."}),e.jsx("div",{className:"text-gray-600 mb-6",children:"Notre équipe va étudier votre dossier et vous recevrez votre contrat d'abonnement sous 48H."}),e.jsx("button",{onClick:()=>p(!1),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Fermer"})]})]})})})]})};async function Zs(t,s,n,a,l){try{const r=new bt;r.setFontSize(20),r.text("Rapport Installation Solaire",105,20,{align:"center"}),r.setFontSize(10),r.setTextColor(100,100,100),r.text("Note : Cette simulation de productible est réalisée avec soin à partir des données disponibles, mais reste indicative et non contractuelle.",20,30,{maxWidth:170}),r.setTextColor(0,0,0),r.setFontSize(14),r.text("Informations client",20,45);const i=[["Civilité",a.civilite],["Nom",a.nom],["Prénom",a.prenom],["Adresse",a.adresse],["Code postal",a.codePostal],["Ville",a.ville],["Téléphone",a.telephone],["Email",a.email],["Point de livraison (PDL)",a.pdl||"Non renseigné"]];B(r,{startY:50,head:[["Information","Valeur"]],body:i,theme:"striped",headStyles:{fillColor:[41,128,185]},margin:{top:50}}),r.addPage(),r.setFontSize(14),r.text("Caractéristiques techniques",20,20);const o=[["Type de compteur",l.typeCompteur==="monophase"?"Monophasé":"Triphasé"],["Consommation annuelle",`${l.consommationAnnuelle.toString()} kWh/an`],["Puissance crête",`${l.puissanceCrete.toFixed(1)} kWc`],["Nombre de modules",l.nombreModules.toString()],["Surface totale",`${l.surfaceTotale.toFixed(1)} m²`],["Orientation",st(l.orientation)],["Inclinaison",`${l.inclinaison}°`],["Pertes système",`${l.pertes}%`],["Masque solaire",`${l.masqueSolaire}%`],["Micro-onduleurs",l.microOnduleurs?"Oui":"Non"],["Technologie bifaciale",l.bifacial?"Oui":"Non"],["Production annuelle estimée",`${Math.round(n).toString()} kWh/an`]];B(r,{startY:25,head:[["Caractéristique","Valeur"]],body:o,theme:"striped",headStyles:{fillColor:[41,128,185]}}),r.text("Informations financières",20,r.lastAutoTable.finalY+20);const c=t.financingMode==="cash"?[["Type de financement","Paiement comptant"],["Prix de base TTC",A(s.prixInstallation)],["Remise commerciale",`${t.remiseCommerciale}%`],["Prime à l'autoconsommation",A(t.primeAutoconsommation)],["Prix final TTC",A(s.prixFinal)]]:[["Type de financement","Abonnement mensuel"],["Durée d'engagement",`${t.dureeAbonnement} ans`],["Mensualité TTC",A(s.projectionAnnuelle[0].coutAbonnement/12)],["Services inclus","Maintenance, garantie, monitoring et assurance"]];B(r,{startY:r.lastAutoTable.finalY+25,head:[["Information financière","Valeur"]],body:c,theme:"striped",headStyles:{fillColor:[41,128,185]}}),r.addPage(),r.setFontSize(14),r.text("Projection financière sur 20 ans",20,20);const d=s.projectionAnnuelle.slice(0,20).map(h=>[h.annee.toString(),Math.round(h.production).toString(),A(h.economiesAutoconsommation),A(h.revenusRevente),A(h.gainTotal)]);B(r,{startY:25,head:[["Année","Production (kWh)","Économies","Revente","Gain total"]],body:d,theme:"striped",headStyles:{fillColor:[41,128,185]}}),r.text("Synthèse financière",20,r.lastAutoTable.finalY+20);const x=[["Économies moyennes annuelles",A(s.moyenneAnnuelle.autoconsommation)],["Revente moyenne annuelle",A(s.moyenneAnnuelle.revente)],["Gain total sur 20 ans",A(s.totalGains)]];B(r,{startY:r.lastAutoTable.finalY+25,head:[["Indicateur","Montant"]],body:x,theme:"striped",headStyles:{fillColor:[41,128,185]}});const p=r.internal.getNumberOfPages();for(let h=1;h<=p;h++)r.setPage(h),r.setFontSize(10),r.setTextColor(150,150,150),r.text(`Page ${h} sur ${p}`,r.internal.pageSize.width-20,r.internal.pageSize.height-10);r.save("rapport-installation-solaire.pdf")}catch(r){throw console.error("Erreur lors de la génération du PDF:",r),r}}function Xs({params:t,projection:s,productionAnnuelle:n,clientInfo:a,installationParams:l}){const[r,i]=u.useState(!1),o=async()=>{i(!0);try{const c={...t,financingMode:t.financingMode||"subscription",prixKwh:t.prixKwh||.25,tarifRevente:t.tarifRevente||.1269,autoconsommation:t.autoconsommation||75,revalorisationEnergie:t.revalorisationEnergie||7,indexationProduction:t.indexationProduction||2,degradationPanneau:t.degradationPanneau||-.2,dureeAbonnement:t.dureeAbonnement||20,primeAutoconsommation:t.primeAutoconsommation||0,remiseCommerciale:t.remiseCommerciale||0};await Zs(c,s,n,a,l)}catch(c){console.error("Erreur lors de la génération du PDF:",c),alert("Une erreur est survenue lors de la génération du PDF. Veuillez réessayer.")}finally{i(!1)}};return e.jsxs("button",{onClick:o,disabled:r,className:`inline-flex items-center gap-2 px-4 py-2 rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors ${r?"opacity-50 cursor-wait":""}`,children:[e.jsx(Wt,{className:"h-5 w-5"}),r?"Génération...":"Télécharger le rapport"]})}function Qs(){const{clientInfo:t,address:s}=D(),{params:n}=nt(),[a,l]=u.useState(""),{parameters:r,projection:i,calculateProjection:o}=lt();u.useEffect(()=>{const p=localStorage.getItem("solarResults");if(p){const{productionAnnuelle:h,puissanceCrete:g}=JSON.parse(p),N=localStorage.getItem("financialMode"),C=localStorage.getItem("subscriptionDuration"),w=localStorage.getItem("primeAutoconsommation"),y=localStorage.getItem("remiseCommerciale");N&&(r.financingMode=N),C&&(r.dureeAbonnement=parseInt(C,10)),w&&(r.primeAutoconsommation=parseFloat(w)),y&&(r.remiseCommerciale=parseFloat(y)),o(h,g)}},[o,r]);const c=p=>{const h=p.target.value.replace(/\D/g,"").slice(0,14);l(h)},d=localStorage.getItem("solarResults")?JSON.parse(localStorage.getItem("solarResults")):null,x={civilite:t.civilite,nom:t.nom,prenom:t.prenom,adresse:s.rue||"",codePostal:s.codePostal||"",ville:s.ville||"",telephone:t.telephone,email:t.email,pdl:a};return e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs($,{to:"/projection",className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700",children:[e.jsx(ge,{className:"h-4 w-4 mr-1"}),"Retour à la projection financière"]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Rapport détaillé"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informations client"}),e.jsxs("dl",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Nom complet"}),e.jsx("dd",{className:"text-sm text-gray-900",children:`${t.civilite} ${t.prenom} ${t.nom}`})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Téléphone"}),e.jsx("dd",{className:"text-sm text-gray-900",children:t.telephone})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Email"}),e.jsx("dd",{className:"text-sm text-gray-900",children:t.email})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Adresse"}),e.jsxs("dl",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Rue"}),e.jsx("dd",{className:"text-sm text-gray-900",children:s.rue||"-"})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Code postal"}),e.jsx("dd",{className:"text-sm text-gray-900",children:s.codePostal||"-"})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Ville"}),e.jsx("dd",{className:"text-sm text-gray-900",children:s.ville||"-"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Numéro PDL (Point De Livraison)"}),e.jsxs("div",{className:"relative group",children:[e.jsx(W,{className:"h-4 w-4 text-gray-400 cursor-help"}),e.jsxs("div",{className:"absolute z-10 invisible group-hover:visible bg-gray-900 text-white text-sm rounded-lg py-2 px-3 w-72 bottom-full left-1/2 -translate-x-1/2 mb-2",children:[e.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-gray-900 rotate-45"}),"Le numéro PDL (Point De Livraison) est un identifiant unique de 14 chiffres qui se trouve sur votre facture d'électricité et sur votre compteur Linky."]})]})]}),e.jsx("input",{type:"text",value:a,onChange:c,placeholder:"14 chiffres",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",maxLength:14}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Facultatif - Vous trouverez ce numéro sur votre facture d'électricité ou sur votre compteur Linky"})]}),e.jsx("div",{className:"flex justify-end",children:d&&i&&e.jsx(Xs,{params:r,projection:i,productionAnnuelle:d.productionAnnuelle,clientInfo:x,installationParams:{typeCompteur:n.typeCompteur,pdl:a,consommationAnnuelle:n.consommationAnnuelle,puissanceCrete:d.puissanceCrete,nombreModules:n.nombreModules,inclinaison:n.inclinaison,orientation:n.orientation,pertes:n.pertes,masqueSolaire:n.masqueSolaire||0,microOnduleurs:n.microOnduleurs||!1,bifacial:n.bifacial||!1,surfaceTotale:d.surfaceTotale}})})]})]})]})}const ea=[{title:"Un contrat flexible",icon:z,color:"blue",points:["Résiliation possible dès la 5ème année","Transfert gratuit en cas de vente","Évolution possible de l'installation"]},{title:"Service premium",icon:Ut,color:"purple",points:["Service client basé en France","Accompagnement personnalisé","Suivi de production en temps réel"]},{title:"Garanties complètes",icon:ss,color:"green",points:["Maintenance gratuite jusqu'à 25 ans","Matériel garanti 30 ans","Assurance tous risques incluse"]},{title:"Haute performance",icon:Ht,color:"orange",points:["Panneaux dernière génération","Micro-onduleurs optimisés","Monitoring avancé"]},{title:"Financement simplifié",icon:Ye,color:"indigo",points:["Sans apport initial","Pas de crédit bancaire","Réponse sous 48h"]},{title:"Engagement durable",icon:Je,color:"emerald",points:["Entreprise à mission","Transition énergétique","Production locale"]}];function ta(){return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Avantages de l'abonnement"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ea.map(t=>e.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-${t.color}-50`,children:e.jsx(t.icon,{className:`h-6 w-6 text-${t.color}-500`})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:t.title})]}),e.jsx("ul",{className:"space-y-3",children:t.points.map(s=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(de,{className:`h-5 w-5 text-${t.color}-500 flex-shrink-0 mt-0.5`}),e.jsx("span",{className:"text-gray-600",children:s})]},s))})]})},t.title))}),e.jsxs("div",{className:"mt-8 bg-blue-50 p-6 rounded-xl text-center",children:[e.jsx("p",{className:"text-lg font-medium text-blue-900",children:"Rejoignez les 100 000 premiers foyers abonnés !"}),e.jsx("p",{className:"mt-2 text-blue-700",children:"Profitez d'une installation solaire clé en main sans investissement initial"})]})]})}const He=[{puissance:"2.5",mensualites:[49,51.6,56.4,67.2],remboursements:[["-",5269,5197,5108,5028,4978,4931,4910,4876,4827,4761,4675,4567,4433,4271,4076,3843,3569,3246,2870,2432,1924,1338,662,0],["-",5190,5071,4930,4937,4747,4685,4594,4476,4327,4144,3920,3649,3327,2944,2492,1961,1342,620,0],["-",5043,4916,4818,4636,4430,4191,3979,3721,3412,3044,2608,2095,775,0],["-",4714,4463,4164,3755,3387,2748,1893,863,0]]},{puissance:"3.0",mensualites:[59,63.6,73.2,86.4],remboursements:[["-",6951,6917,6855,6767,6625,6365,6251,6121,5971,5801,5608,5391,5148,4876,4572,4234,3860,3445,2988,2484,1929,1320,653,0],["-",6821,6711,6564,6382,6233,6054,5859,5633,5374,5077,4739,4356,3922,3432,2880,2260,1564,784,0],["-",6548,6280,6041,5760,5434,5055,4634,4154,3608,2989,2288,1495,1e3,0],["-",5982,5495,4942,4316,3609,2813,1930,1103,0]]},{puissance:"3.5",mensualites:[68.5,72,80.4,97.2],remboursements:[["-",7684,7619,7568,7471,7349,7227,7151,7055,6937,6794,6624,6423,6189,5917,5603,5244,4833,4366,3836,3236,2560,1799,944,0],["-",7582,7458,7339,7168,6962,6746,6558,6335,6073,5768,5413,5004,4534,3996,3382,2683,1889,989,0],["-",7192,7070,6915,6725,6493,6023,5608,5114,4530,3847,3051,2129,1068,0],["-",6641,6189,5663,5054,4351,3333,2352,1232,0]]},{puissance:"4.0",mensualites:[78,83,91,107],remboursements:[["-",8440,8346,8300,8194,8140,8064,7980,7874,7744,7586,7399,7178,6919,6620,6274,5878,5426,4912,4330,3671,2928,2093,1156,0],["-",8301,8125,7987,7778,7665,7469,7252,6997,6699,6353,5953,5493,4965,4363,3677,2896,2012,1010,0],["-",7977,7814,7612,7365,7068,6502,6062,5551,4963,4288,3514,2629,1251,0],["-",7452,6976,6421,5777,5033,3940,2935,1368,0]]},{puissance:"4.5",mensualites:[87,92,102,120],remboursements:[["-",9285,9165,9097,9065,9012,8850,8750,8624,8472,8290,8073,7820,7525,7185,6795,6348,5840,5265,4614,3880,3056,2131,1096,0],["-",9050,8879,8770,8629,8451,8232,7993,7711,7382,7e3,6559,6052,5471,4808,4052,3194,2222,1120,0],["-",8762,8559,8308,8005,7642,7058,6545,5952,5269,4485,3587,2560,1400,0],["-",8093,7496,6805,6009,5095,4049,2875,1538,0]]},{puissance:"5.0",mensualites:[96,100.8,111.6,134.4],remboursements:[["-",10322,10262,10178,10111,10065,9994,9906,9789,9641,9457,9233,8965,8647,8272,7835,7329,6744,6072,5302,4424,3424,2289,1002,0],["-",10183,10041,9864,9692,9527,9321,9075,8778,8426,8010,7523,6955,6299,5541,4670,3672,2531,1231,0],["-",9870,9543,9158,8750,8316,7807,7235,6576,5817,4948,3955,2821,1530,0],["-",9098,8492,7784,6959,6004,4827,3390,1724,0]]},{puissance:"5.5",mensualites:[105.5,111.6,122.4,144],remboursements:[["-",11283,11205,11074,10933,10860,10756,10641,10496,10317,10100,9841,9535,9177,8761,8281,7730,7099,6380,5564,4639,3595,2418,1094,0],["-",11106,10923,10674,10400,10176,9901,9606,9261,8859,8395,7861,7249,6550,5754,4850,3825,2667,1358,0],["-",10727,10490,10152,9760,9345,8387,7762,7047,6231,5301,4243,3042,1679,0],["-",9999,9392,8680,7848,6881,4815,3421,1845,0]]},{puissance:"6.0",mensualites:[115,120,130.8,153.6],remboursements:[["-",12342,12090,11922,11780,11626,11506,11377,11216,11019,10781,10498,10166,9778,9329,8812,8220,7544,6776,5906,4924,3817,2573,1177,0],["-",12194,11857,11592,11340,11147,10905,10620,10276,9867,9384,8817,8157,7391,6507,5489,4321,2985,1460,0],["-",11875,11535,11386,11190,10679,10091,9451,8665,7712,6573,5224,3640,1794,0],["-",11090,10463,9608,8805,7489,6139,4415,2400,0]]},{puissance:"6.5",mensualites:[124,129.6,142.8,165.6],remboursements:[["-",12885,12724,12661,12550,12429,12116,11983,11816,11610,11362,11066,10717,10310,9838,9294,8670,7958,7148,6230,5193,4025,2713,1242,0],["-",12347,12306,12232,12121,11968,11425,11122,10759,10328,9820,9227,8536,7737,6816,5756,4541,3152,1567,0],["-",12208,11880,11615,11285,10879,9842,9156,8353,7418,6332,5077,3629,1963,0],["-",11305,10628,9828,8889,7793,5694,4032,2124,0]]},{puissance:"7.0",mensualites:[132,138,150,174],remboursements:[["-",13300,13214,13093,12838,12620,12432,12250,12033,11776,11476,11128,10729,10272,9752,9165,8505,7765,6939,6021,5005,3884,2652,1303,0],["-",13124,12933,12692,12303,11933,11570,11206,10784,10298,9742,9109,8388,7572,6650,5611,4442,3131,1663,0],["-",12670,12291,11946,11524,11014,9958,9226,8388,7430,6336,5090,3673,2062,0],["-",11703,10910,9983,8904,7654,6118,4314,2231,0]]},{puissance:"7.5",mensualites:[140,146.4,159.6,178.8],remboursements:[["-",13790,13639,13534,13482,13393,13262,13124,12949,12731,12466,12149,11773,11332,10818,10225,9542,8761,7872,6861,5718,4429,2979,1353,0],["-",13602,13339,13164,12983,12746,12446,12116,11722,11254,10703,10060,9311,8445,7446,6297,4980,3474,1755,0],["-",13109,12843,12507,12092,11585,10973,10241,9371,8346,7143,5736,4099,2197,0],["-",12040,11159,10139,8961,7608,6059,4320,2291,0]]},{puissance:"8.0",mensualites:[149,156,169.2,192],remboursements:[["-",14529,14437,14274,14092,13783,13590,13405,13179,12909,12591,12220,11790,11295,10731,10090,9367,8553,7644,6630,5506,4265,2902,1411,0],["-",14321,14149,13861,13620,13383,13079,12744,12341,11860,11291,10622,9842,8936,7887,6676,5284,3688,1860,0],["-",13846,13563,13145,12651,12120,11477,10716,9813,8746,7493,6028,4319,2331,0],["-",12615,11701,10634,9394,7960,6204,4450,2464,0]]},{puissance:"8.5",mensualites:[158,164.4,177.6,200.4],remboursements:[["-",15135,14980,14710,14461,14292,14067,13855,13601,13300,12949,12543,12075,11542,10938,10257,9494,8643,7699,6657,5514,4268,2918,1466,0],["-",14945,14815,14668,14484,14313,13115,12702,12224,11673,11043,10324,9508,8584,7542,6370,5057,3589,1954,0],["-",14407,14092,13632,13090,12505,11153,10326,9387,8321,7112,5744,4196,2448,0],["-",13151,12196,11080,9784,8284,6449,4629,2572,0]]},{puissance:"9.0",mensualites:[167,174,189.6,206.4],remboursements:[["-",15706,15619,15524,15362,15179,14745,14554,14320,14038,13702,13309,12850,12322,11717,11029,10250,9375,8395,7305,6099,4771,3318,1739,0],["-",15496,15282,15040,14710,14334,13683,13269,12785,12225,11579,10839,9994,9034,7946,6718,5336,3786,2054,0],["-",14880,14625,14292,13868,13339,12689,11892,10930,9779,8408,6785,4870,2618,0],["-",14322,13722,12990,12104,11043,9395,6330,2648,0]]}];function sa({data:t}){const s=["25 ans","20 ans","15 ans","10 ans"],n=Array.from({length:25},(a,l)=>l+1);return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsxs("caption",{className:"text-lg font-semibold py-2",children:["Puissance Crête : ",t.puissance," kWc"]}),e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Durée"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mensualité"}),n.map(a=>e.jsx("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:a},a))]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map((a,l)=>e.jsxs("tr",{className:l%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:a}),e.jsxs("td",{className:"px-3 py-4 whitespace-nowrap text-sm text-gray-900",children:[t.mensualites[l].toFixed(2)," €"]}),t.remboursements[l].map((r,i)=>e.jsx("td",{className:`px-3 py-4 whitespace-nowrap text-sm text-right ${i<5?"bg-gray-100 text-gray-400":"text-gray-900"}`,children:r===0||r==="-"?"-":`${r} €`},i))]},l))})]})})}const aa=5;function na(){return e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsx("div",{className:"bg-amber-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("p",{className:"text-sm text-amber-800",children:["Les ",aa," premières années sont grisées car elles correspondent à la période d'engagement minimum. Aucune sortie n'est possible pendant cette période"]}),e.jsxs("div",{className:"relative group",children:[e.jsx(W,{className:"h-4 w-4 text-amber-600 cursor-help flex-shrink-0"}),e.jsxs("div",{className:"absolute z-10 invisible group-hover:visible bg-gray-900 text-white text-sm rounded-lg py-2 px-3 w-80 -right-2 top-6",children:[e.jsx("div",{className:"absolute -top-1 right-3 w-2 h-2 bg-gray-900 rotate-45"}),e.jsx("p",{className:"font-medium mb-1",children:"Cas particuliers de sortie anticipée :"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Décès du souscripteur"}),e.jsx("li",{children:"• Divorce ou dissolution de PACS"}),e.jsx("li",{children:"• Déménagement hors zone de couverture"})]}),e.jsx("p",{className:"mt-2 text-xs text-gray-300",children:"Ces situations font l'objet d'une étude au cas par cas et peuvent permettre une sortie anticipée sans pénalités."})]})]})]})}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-blue-800",children:"Les valeurs indiquées correspondent aux montants à verser pour sortir du contrat à la date anniversaire de l'année correspondante. Ces montants sont garantis et incluent la TVA."})})]})}function ra(){const[t,s]=u.useState(0);return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Modalités de sortie"}),e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx("select",{value:t,onChange:n=>s(Number(n.target.value)),className:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:He.map((n,a)=>e.jsxs("option",{value:a,children:[n.puissance," kWc"]},n.puissance))})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx(sa,{data:He[t]})}),e.jsx(na,{})]})}const _=class _{constructor(){X(this,"accessToken",null);X(this,"config",{clientId:void 0,clientSecret:void 0,redirectUri:void 0,authUrl:"https://mon-compte-particulier.enedis.fr/dataconnect/v1/oauth2/authorize",tokenUrl:"https://gw.hml.api.enedis.fr/oauth2/v3/token",apiUrl:"https://gw.hml.api.enedis.fr/v5/metering_data",scope:"fr_be_cons_detail_load_curve"})}static getInstance(){return _.instance||(_.instance=new _),_.instance}async initiateAuth(){const s=new URLSearchParams({response_type:"code",client_id:this.config.clientId,redirect_uri:this.config.redirectUri,duration:"P1Y",state:"AbieLink1",scope:this.config.scope}),n=`${this.config.authUrl}?${s.toString()}`;return console.log("URL d'authentification générée:",n),n}async handleCallback(s){try{console.log("Échange du code contre un token...");const n=await fetch(this.config.tokenUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"authorization_code",client_id:this.config.clientId,client_secret:this.config.clientSecret,code:s,redirect_uri:this.config.redirectUri})});if(!n.ok){const r=await n.json();throw console.error("Erreur réponse token:",r),new Error(r.error_description||"Échec de l'échange du token")}const a=await n.json();console.log("Token reçu avec succès"),localStorage.setItem("enedis_access_token",a.access_token),a.refresh_token&&localStorage.setItem("enedis_refresh_token",a.refresh_token);const l=new Date;l.setSeconds(l.getSeconds()+a.expires_in),localStorage.setItem("enedis_token_expires",l.toISOString()),console.log("Token Enedis stocké avec succès")}catch(n){throw console.error("Erreur détaillée dans handleCallback:",n),n}}async getConsumptionData(s,n,a){try{const l=await this.getValidToken();if(!l)throw new Error("Non authentifié");console.log("Récupération des données de consommation...");const r=await fetch(`${this.config.apiUrl}/daily_consumption?usage_point_id=${s}&start=${n}&end=${a}`,{headers:{Authorization:`Bearer ${l}`,Accept:"application/json"}});if(!r.ok)throw console.error("Erreur API:",r.status,r.statusText),new Error("Échec de la récupération des données");const i=await r.json();return this.formatConsumptionData(i)}catch(l){throw console.error("Erreur lors de la récupération des données:",l),l}}async getValidToken(){const s=localStorage.getItem("enedis_access_token"),n=localStorage.getItem("enedis_token_expires");if(!s||!n)return null;if(new Date(n)<=new Date){const a=localStorage.getItem("enedis_refresh_token");if(a)try{return await this.refreshToken(a),localStorage.getItem("enedis_access_token")}catch(l){return console.error("Erreur refresh token:",l),null}return null}return s}async refreshToken(s){const n=await fetch(this.config.tokenUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",client_id:this.config.clientId,client_secret:this.config.clientSecret,refresh_token:s})});if(!n.ok)throw new Error("Échec du rafraîchissement du token");const a=await n.json();localStorage.setItem("enedis_access_token",a.access_token),a.refresh_token&&localStorage.setItem("enedis_refresh_token",a.refresh_token);const l=new Date;l.setSeconds(l.getSeconds()+a.expires_in),localStorage.setItem("enedis_token_expires",l.toISOString())}formatConsumptionData(s){var l;if(!((l=s==null?void 0:s.meter_reading)!=null&&l.interval_reading))throw new Error("Format de données invalide");return{consumption:s.meter_reading.interval_reading.map(r=>({date:r.date,peakHours:r.value*(r.measure_type==="HP"?1:0),offPeakHours:r.value*(r.measure_type==="HC"?1:0)}))}}};X(_,"instance");let he=_;const pe=he.getInstance(),it="enedis_consumption_data";async function la(t){try{const s=ot(),n=oa(s,t);return localStorage.setItem(it,JSON.stringify(n)),n}catch(s){throw console.error("Erreur lors de la sauvegarde des données:",s),s}}async function ia(t,s,n){try{const a=ot();return ca(a,t,s,n)}catch(a){throw console.error("Erreur lors de la récupération des données:",a),a}}function ot(){const t=localStorage.getItem(it);return t?JSON.parse(t):[]}function oa(t,s){const n=new Map(t.map(a=>[`${a.prm}-${a.date}`,a]));return s.forEach(a=>{n.set(`${a.prm}-${a.date}`,a)}),Array.from(n.values())}function ca(t,s,n,a){const l=new Date(n),r=new Date(a);return t.filter(i=>{const o=new Date(i.date);return i.prm===s&&o>=l&&o<=r}).sort((i,o)=>new Date(i.date).getTime()-new Date(o.date).getTime())}function da(){const[t,s]=u.useState(!1),[n,a]=u.useState(null),[l,r]=u.useState(null),[i,o]=u.useState(!1),c=u.useCallback(async p=>{s(!0),a(null);try{const h=await pe.testConnection(p);return o(h),h}catch(h){const g=h instanceof Error?h.message:"Erreur lors du test de connexion";return a(g),!1}finally{s(!1)}},[]),d=u.useCallback(async p=>{s(!0),a(null);try{if(!await c(p))throw new Error("Impossible de se connecter au compteur");const g=new Date().toISOString().split("T")[0],N=new Date(Date.now()-365*24*60*60*1e3).toISOString().split("T")[0],w=(await pe.getConsumptionData(p,N,g)).consumption.map(j=>({prm:p,date:j.date,peakHours:j.peakHours||0,offPeakHours:j.offPeakHours||0}));await la(w);const y=await ia(p,N,g);r(y)}catch(h){const g=h instanceof Error?h.message:"Erreur lors de la récupération des données";a(g),r(null)}finally{s(!1)}},[c]),x=u.useCallback(()=>{localStorage.removeItem("enedis_consumption_data"),r(null),o(!1),a(null)},[]);return{isLoading:t,error:n,consumptionData:l,isConnected:i,testConnection:c,fetchConsumptionData:d,resetData:x}}const q={peakHours:.2062,offPeakHours:.1547},ma=({data:t,onReset:s})=>{var k;const{clientInfo:n}=D(),a=t.reduce((m,S)=>{const M=new Date(S.date),v=`${M.getFullYear()}-${String(M.getMonth()+1).padStart(2,"0")}`;return m[v]||(m[v]={date:v,peakHours:0,offPeakHours:0,peakCost:0,offPeakCost:0}),m[v].peakHours+=S.peakHours,m[v].offPeakHours+=S.offPeakHours,m[v].peakCost+=S.peakHours*q.peakHours,m[v].offPeakCost+=S.offPeakHours*q.offPeakHours,m},{}),l=Object.values(a).map(m=>({...m,date:new Date(m.date+"-01").toLocaleDateString("fr-FR",{month:"short",year:"numeric"})})),r=l.reduce((m,S)=>m+S.peakHours,0),i=l.reduce((m,S)=>m+S.offPeakHours,0),o=r+i,c=r*q.peakHours,d=i*q.offPeakHours,x=c+d,p=t.length,h=o/p,g=r/p,N=i/p,C=t.map(m=>({date:m.date,total:m.peakHours+m.offPeakHours})),w=Math.max(...C.map(m=>m.total)),y=(k=C.find(m=>m.total===w))==null?void 0:k.date,j=y?new Date(y).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}):"",P=r/o*100,f=i/o*100;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Analyse de consommation"}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ns,{className:"h-5 w-5"}),e.jsxs("span",{children:["Point de livraison de ",n.civilite," ",n.nom," ",n.prenom]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Consommation totale"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-700",children:[Math.round(o).toLocaleString()," kWh"]}),e.jsxs("div",{className:"mt-1 text-sm",children:[e.jsxs("p",{className:"text-blue-600",children:["HP: ",Math.round(r).toLocaleString()," kWh"]}),e.jsxs("p",{className:"text-blue-600",children:["HC: ",Math.round(i).toLocaleString()," kWh"]})]})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Dépenses totales"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[Math.round(x).toLocaleString()," €"]}),e.jsxs("p",{className:"mt-1 text-sm text-green-600",children:[(x/l.length).toFixed(2)," €/mois"]})]}),e.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-indigo-600 font-medium",children:"Prix heures pleines"}),e.jsxs("p",{className:"text-2xl font-bold text-indigo-700",children:[(q.peakHours*100).toFixed(2)," c€/kWh"]}),e.jsx("p",{className:"mt-1 text-sm text-indigo-600",children:"6h-22h en semaine"})]}),e.jsxs("div",{className:"bg-teal-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-teal-600 font-medium",children:"Prix heures creuses"}),e.jsxs("p",{className:"text-2xl font-bold text-teal-700",children:[(q.offPeakHours*100).toFixed(2)," c€/kWh"]}),e.jsx("p",{className:"mt-1 text-sm text-teal-600",children:"22h-6h + week-ends"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ve,{className:"h-5 w-5 text-purple-500"}),e.jsx("h3",{className:"font-medium text-purple-900",children:"Moyennes journalières"})]}),e.jsxs("p",{className:"text-2xl font-bold text-purple-700",children:[h.toFixed(1)," kWh/jour"]}),e.jsxs("div",{className:"mt-2 text-sm space-y-1",children:[e.jsxs("p",{className:"text-purple-600",children:["HP: ",g.toFixed(1)," kWh/jour"]}),e.jsxs("p",{className:"text-purple-600",children:["HC: ",N.toFixed(1)," kWh/jour"]})]})]}),e.jsxs("div",{className:"bg-amber-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ne,{className:"h-5 w-5 text-amber-500"}),e.jsx("h3",{className:"font-medium text-amber-900",children:"Pic de consommation"})]}),e.jsxs("p",{className:"text-2xl font-bold text-amber-700",children:[w.toFixed(1)," kWh"]}),e.jsxs("p",{className:"mt-2 text-sm text-amber-600",children:["Atteint le ",j]})]}),e.jsxs("div",{className:"bg-rose-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ye,{className:"h-5 w-5 text-rose-500"}),e.jsx("h3",{className:"font-medium text-rose-900",children:"Répartition HP/HC"})]}),e.jsxs("div",{className:"relative pt-1",children:[e.jsxs("div",{className:"flex mb-2 items-center justify-between",children:[e.jsx("div",{children:e.jsx("span",{className:"text-xs font-semibold inline-block text-rose-600",children:"Heures pleines"})}),e.jsx("div",{children:e.jsxs("span",{className:"text-xs font-semibold inline-block text-rose-600",children:[P.toFixed(1),"%"]})})]}),e.jsx("div",{className:"overflow-hidden h-2 text-xs flex rounded bg-rose-200",children:e.jsx("div",{style:{width:`${P}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-rose-500"})}),e.jsxs("div",{className:"flex mt-2 items-center justify-between",children:[e.jsx("div",{children:e.jsx("span",{className:"text-xs font-semibold inline-block text-rose-600",children:"Heures creuses"})}),e.jsx("div",{children:e.jsxs("span",{className:"text-xs font-semibold inline-block text-rose-600",children:[f.toFixed(1),"%"]})})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Consommation électrique mensuelle (kWh)"}),e.jsx("div",{className:"h-[400px] w-full",children:e.jsx(Se,{width:"100%",height:"100%",children:e.jsxs(Ce,{data:l,margin:{top:5,right:30,left:20,bottom:20},barSize:20,barGap:0,children:[e.jsx(Pe,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),e.jsx(Ae,{dataKey:"date",angle:-45,textAnchor:"end",height:60,tick:{fontSize:12}}),e.jsx(Me,{unit:" kWh",tick:{fontSize:12},width:80}),e.jsx(Ee,{formatter:(m,S)=>[`${Math.round(m)} kWh`,S==="peakHours"?"Heures pleines":"Heures creuses"],contentStyle:{backgroundColor:"white",border:"1px solid #E5E7EB",borderRadius:"0.375rem",padding:"8px 12px"},cursor:{fill:"rgba(229, 231, 235, 0.2)"}}),e.jsx(Ie,{verticalAlign:"top",height:36,formatter:m=>m==="peakHours"?"Heures pleines":"Heures creuses"}),e.jsx(Q,{dataKey:"peakHours",name:"peakHours",stackId:"consumption",fill:"#4F46E5",radius:[4,4,0,0]}),e.jsx(Q,{dataKey:"offPeakHours",name:"offPeakHours",stackId:"consumption",fill:"#14B8A6",radius:[4,4,0,0]})]})})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Dépenses mensuelles (€)"}),e.jsx("div",{className:"h-[400px] w-full",children:e.jsx(Se,{width:"100%",height:"100%",children:e.jsxs(Ce,{data:l,margin:{top:5,right:30,left:20,bottom:20},barSize:20,barGap:0,children:[e.jsx(Pe,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),e.jsx(Ae,{dataKey:"date",angle:-45,textAnchor:"end",height:60,tick:{fontSize:12}}),e.jsx(Me,{unit:" €",tick:{fontSize:12},width:80}),e.jsx(Ee,{formatter:(m,S)=>[`${m.toFixed(2)} €`,S==="peakCost"?"Coût heures pleines":"Coût heures creuses"],contentStyle:{backgroundColor:"white",border:"1px solid #E5E7EB",borderRadius:"0.375rem",padding:"8px 12px"},cursor:{fill:"rgba(229, 231, 235, 0.2)"}}),e.jsx(Ie,{verticalAlign:"top",height:36,formatter:m=>m==="peakCost"?"Coût heures pleines":"Coût heures creuses"}),e.jsx(Q,{dataKey:"peakCost",name:"peakCost",stackId:"cost",fill:"#8B5CF6",radius:[4,4,0,0]}),e.jsx(Q,{dataKey:"offPeakCost",name:"offPeakCost",stackId:"cost",fill:"#EC4899",radius:[4,4,0,0]})]})})})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:s,className:"inline-flex items-center gap-2 px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[e.jsx(je,{className:"h-4 w-4"}),"Réinitialiser les données"]})})]})},ua=()=>{u.useState(!1);const{consumptionData:t,resetData:s}=da(),n=()=>{window.open("https://mon-compte-particulier.enedis.fr/dataconnect/v1/oauth2/authorize?client_id=Y_LuB7HsQW3JWYudw7HRmN28FN8a&duration=P1Y&response_type=code&state=AbieLink1","_blank")};return e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 text-white mb-4",children:[e.jsx(ae,{className:"h-8 w-8"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Abie Link"})]}),e.jsx("p",{className:"text-blue-100",children:"Connectez votre compteur Linky pour suivre votre consommation d'énergie en temps réel et optimiser votre installation solaire."})]}),t?e.jsx(ma,{data:t,onReset:s}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Xe,{className:"h-5 w-5 text-blue-500"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Suivi en temps réel"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Visualisez votre consommation d'énergie au jour le jour"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(me,{className:"h-5 w-5 text-green-500"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Sécurisé"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Vos données sont protégées et confidentielles"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(se,{className:"h-5 w-5 text-purple-500"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Optimisation"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Optimisez votre installation solaire selon vos besoins"})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-6 mt-8",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 max-w-2xl w-full text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-blue-900 mb-4",children:"Nouvelle version bientôt disponible !"}),e.jsx("p",{className:"text-blue-800 mb-4",children:"Une nouvelle version d'Abie Link est en cours de développement. En attendant, vous pouvez continuer à utiliser l'ancienne version."}),e.jsxs("a",{href:"https://fabulous-praline-ae9982.netlify.app",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[e.jsx(ae,{className:"h-5 w-5"}),"Accéder à l'ancienne version"]})]}),e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-6 max-w-2xl w-full text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-amber-900 mb-4",children:"Nouvelle version"}),e.jsx("p",{className:"text-amber-800 mb-4",children:"La nouvelle version d'Abie Link sera bientôt disponible avec de nouvelles fonctionnalités."}),e.jsxs("button",{onClick:n,disabled:!0,className:"inline-flex items-center gap-2 px-6 py-3 bg-gray-400 text-white rounded-lg cursor-not-allowed",children:[e.jsx(me,{className:"h-5 w-5"}),"Bientôt disponible"]})]})]})]})]})};function xa(){const t=V(),s=J();return u.useEffect(()=>{const n=async()=>{try{console.log("URL de callback complète:",s.search);const a=new URLSearchParams(s.search),l=a.get("code"),r=a.get("state"),i=a.get("usage_point_id");if(console.log("Paramètres reçus:",{code:l?"***"+l.slice(-6):null,state:r,usagePointId:i}),!l)throw console.error("Code d'autorisation manquant dans les paramètres"),new Error("Code d'autorisation manquant");if(r!=="AbieLink1")throw console.error("État invalide reçu:",r),new Error("État invalide");i&&(console.log("Sauvegarde du PDL:",i),localStorage.setItem("enedis_usage_point_id",i)),console.log("Échange du code contre un token..."),await pe.handleCallback(l),console.log("Échange du code réussi"),console.log("Redirection vers Abie Link avec succès"),t("/abie-link",{state:{success:!0,pdl:i,message:"Connexion à Enedis réussie"},replace:!0})}catch(a){console.error("Erreur détaillée lors de la connexion Enedis:",a),t("/abie-link",{state:{error:a instanceof Error?a.message:"Échec de la connexion à Enedis"},replace:!0})}};s.search?(console.log("Démarrage du traitement du callback Enedis"),n()):(console.log("Aucun paramètre dans l'URL, redirection vers Abie Link"),t("/abie-link",{replace:!0}))},[t,s]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Connexion à Enedis en cours..."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Veuillez patienter pendant que nous traitons votre demande"})]})})}const ha=[{power:2.5,commercial:300,superAgency:400},{power:3,commercial:600,superAgency:700},{power:3.5,commercial:650,superAgency:750},{power:4,commercial:700,superAgency:800},{power:4.5,commercial:800,superAgency:1e3},{power:5,commercial:900,superAgency:1100},{power:5.5,commercial:1e3,superAgency:1200},{power:6,commercial:1200,superAgency:1400},{power:6.5,commercial:1300,superAgency:1500},{power:7,commercial:1400,superAgency:1600},{power:7.5,commercial:1500,superAgency:1700},{power:8,commercial:1600,superAgency:1800},{power:8.5,commercial:1700,superAgency:1900},{power:9,commercial:1800,superAgency:2e3}],pa="151515";function ga(){const[t,s]=u.useState(!1),[n,a]=u.useState(""),[l,r]=u.useState(""),i=o=>{o.preventDefault(),n===pa?(s(!0),r("")):r("Code d'accès incorrect")};return t?e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Informations agence"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Barème applicable aux commerciaux et super régies"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(Ke,{className:"h-6 w-6 text-blue-500"})}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Rémunération maximale"})]}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"2 000 €"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Pour les super régies"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:e.jsx(ve,{className:"h-6 w-6 text-green-500"})}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Progression moyenne"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:"+100 €"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Par palier de puissance"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:e.jsx(Ft,{className:"h-6 w-6 text-purple-500"})}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Bonus super régie"})]}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:"+200 €"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"En moyenne par installation"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-5 w-5 text-gray-400"}),e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Barème détaillé"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Puissance crête"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Commercial"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Super régie (≥10/mois)"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ha.map((o,c)=>e.jsxs("tr",{className:c%2===0?"bg-white":"bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[o.power.toFixed(1)," kWc"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:[o.commercial.toLocaleString("fr-FR")," €"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900",children:[o.superAgency.toLocaleString("fr-FR")," €"]})]},o.power))})]})})]}),e.jsx("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Note :"})," Les super régies doivent réaliser un minimum de 10 installations par mois pour bénéficier du barème majoré. Les rémunérations sont versées à la mise en service de l'installation."]})})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto h-12 w-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(me,{className:"h-6 w-6 text-blue-600"})}),e.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Accès restreint"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Veuillez saisir le code d'accès pour consulter les informations agence"})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:i,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"accessCode",className:"sr-only",children:"Code d'accès"}),e.jsx("input",{id:"accessCode",type:"password",value:n,onChange:o=>a(o.target.value),className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Code d'accès",required:!0})]}),l&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsx("p",{className:"text-sm text-red-700",children:l})}),e.jsx("button",{type:"submit",className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Accéder"})]})]})})}function fa(){const{settings:t,updateSettings:s,addInstallationPrice:n,removeInstallationPrice:a}=re(),[l,r]=u.useState(t),[i,o]=u.useState(!1),[c,d]=u.useState(""),[x,p]=u.useState(""),[h,g]=u.useState(null),[N,C]=u.useState(!1),[w,y]=u.useState({financial:!0,subsidies:!1,prices:!1,proPrices:!1}),j=v=>E=>{const R=parseFloat(E.target.value);isNaN(R)||r(F=>({...F,[v]:R}))},P=v=>{r(E=>({...E,sellPriceDate:v.target.value}))},f=v=>{r(E=>({...E,subsidyDate:v.target.value}))},k=v=>E=>{const R=parseFloat(E.target.value);if(!isNaN(R)){const F=[...l.installationPrices];F[v]={...F[v],price:R},r(L=>({...L,installationPrices:F}))}},m=()=>{const v=parseFloat(c),E=parseFloat(x);if(isNaN(v)||isNaN(E)||v<=0||E<=0){g("Veuillez entrer des valeurs valides");return}if(v<=9){g("La puissance doit être supérieure à 9 kWc");return}n(v,E),d(""),p(""),g(null),C(!0),setTimeout(()=>C(!1),3e3)},S=()=>{s(l),o(!0),setTimeout(()=>o(!1),3e3)},M=v=>{y(E=>({...E,[v]:!E[v]}))};return e.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Réglages"}),e.jsxs("button",{onClick:S,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(es,{className:"h-4 w-4 mr-2"}),"Appliquer les modifications"]})]}),i&&e.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-md",children:e.jsx("p",{className:"text-sm text-green-600",children:"Les modifications ont été appliquées avec succès"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("button",{onClick:()=>M("financial"),className:"w-full px-6 py-4 flex items-center justify-between text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($t,{className:"h-5 w-5 text-blue-500"}),e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Paramètres financiers"})]}),w.financial?e.jsx(ee,{className:"h-5 w-5 text-gray-400"}):e.jsx(U,{className:"h-5 w-5 text-gray-400"})]}),w.financial&&e.jsxs("div",{className:"px-6 pb-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prix du kWh par défaut"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("input",{type:"number",value:l.baseKwhPrice,onChange:j("baseKwhPrice"),step:"0.0001",min:"0",className:"block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"€/kWh"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tarif de revente par défaut"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("input",{type:"number",value:l.baseSellPrice,onChange:j("baseSellPrice"),step:"0.0001",min:"0",className:"block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"€/kWh"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date du tarif de revente"}),e.jsx("input",{type:"date",value:l.sellPriceDate,onChange:P,className:"block w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Niveau d'autoconsommation par défaut"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("input",{type:"number",value:l.defaultAutoconsumption,onChange:j("defaultAutoconsumption"),step:"1",min:"0",max:"100",className:"block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"%"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Revalorisation annuelle par défaut"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("input",{type:"number",value:l.defaultEnergyRevaluation,onChange:j("defaultEnergyRevaluation"),step:"0.1",className:"block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"%"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Indexation de la revente par défaut"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("input",{type:"number",value:l.defaultSellIndexation,onChange:j("defaultSellIndexation"),step:"0.1",className:"block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"%"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dégradation panneaux par défaut"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("input",{type:"number",value:l.defaultPanelDegradation,onChange:j("defaultPanelDegradation"),step:"0.1",className:"block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"%"})})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("button",{onClick:()=>M("subsidies"),className:"w-full px-6 py-4 flex items-center justify-between text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(zt,{className:"h-5 w-5 text-green-500"}),e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Primes & Subventions"})]}),w.subsidies?e.jsx(ee,{className:"h-5 w-5 text-gray-400"}):e.jsx(U,{className:"h-5 w-5 text-gray-400"})]}),w.subsidies&&e.jsxs("div",{className:"px-6 pb-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de validité des primes"}),e.jsx("input",{type:"date",value:l.subsidyDate,onChange:f,className:"block w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prime ≤ 3 kWc"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("input",{type:"number",value:l.defaultSubsidyUnder3kw,onChange:j("defaultSubsidyUnder3kw"),step:"1",min:"0",className:"block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"€/kWc"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prime 3-9 kWc"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("input",{type:"number",value:l.defaultSubsidyOver3kw,onChange:j("defaultSubsidyOver3kw"),step:"1",min:"0",className:"block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"€/kWc"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prime 9-36 kWc"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("input",{type:"number",value:l.defaultSubsidy9to36kw,onChange:j("defaultSubsidy9to36kw"),step:"1",min:"0",className:"block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"€/kWc"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prime 36-100 kWc"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("input",{type:"number",value:l.defaultSubsidy36to100kw,onChange:j("defaultSubsidy36to100kw"),step:"1",min:"0",className:"block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"€/kWc"})})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("button",{onClick:()=>M("prices"),className:"w-full px-6 py-4 flex items-center justify-between text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(be,{className:"h-5 w-5 text-indigo-500"}),e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Prix des installations"})]}),w.prices?e.jsx(ee,{className:"h-5 w-5 text-gray-400"}):e.jsx(U,{className:"h-5 w-5 text-gray-400"})]}),w.prices&&e.jsx("div",{className:"px-6 pb-6",children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:l.installationPrices.filter(v=>v.power<=9).map((v,E)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[v.power," kWc"]}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("input",{type:"number",value:v.price,onChange:k(E),step:"10",min:"0",className:"block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"€"})})]})]},v.power))})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("button",{onClick:()=>M("proPrices"),className:"w-full px-6 py-4 flex items-center justify-between text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Tt,{className:"h-5 w-5 text-purple-500"}),e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Prix des installations pro"})]}),w.proPrices?e.jsx(ee,{className:"h-5 w-5 text-gray-400"}):e.jsx(U,{className:"h-5 w-5 text-gray-400"})]}),w.proPrices&&e.jsx("div",{className:"px-6 pb-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:l.installationPrices.filter(v=>v.power>9).map(v=>e.jsxs("div",{className:"relative bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-medium",children:[v.power," kWc"]}),e.jsx("button",{onClick:()=>a(v.power),className:"text-gray-400 hover:text-red-500",children:e.jsx(as,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"text-lg font-bold text-gray-900",children:[v.price.toLocaleString()," €"]})]},v.power))}),e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Ajouter un nouveau kit"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Puissance (kWc)"}),e.jsx("input",{type:"number",value:c,onChange:v=>d(v.target.value),min:"9.5",step:"0.5",className:"block w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prix (€)"}),e.jsx("input",{type:"number",value:x,onChange:v=>p(v.target.value),min:"0",step:"100",className:"block w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]})]}),h&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:h}),N&&e.jsx("p",{className:"mt-2 text-sm text-green-600",children:"Kit ajouté avec succès"}),e.jsx("button",{onClick:m,className:"mt-3 w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Ajouter"})]})]})})]})]})]})}function oe({children:t}){const{clientInfo:s}=D();return!(s.civilite&&s.nom&&s.prenom)?e.jsx(ht,{to:"/",replace:!0}):e.jsx(e.Fragment,{children:t})}function ba(){return e.jsx(pt,{children:e.jsx(At,{children:e.jsx(Mt,{children:e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ds,{}),e.jsx(cs,{children:e.jsxs(gt,{children:[e.jsx(T,{path:"/",element:e.jsx(Ls,{})}),e.jsx(T,{path:"/projection",element:e.jsx(oe,{children:e.jsx(Ys,{})})}),e.jsx(T,{path:"/eligibilite",element:e.jsx(oe,{children:e.jsx(Js,{})})}),e.jsx(T,{path:"/rapport",element:e.jsx(oe,{children:e.jsx(Qs,{})})}),e.jsx(T,{path:"/modalites-abonnement",element:e.jsx(ta,{})}),e.jsx(T,{path:"/modalites-sortie",element:e.jsx(ra,{})}),e.jsx(T,{path:"/abie-link",element:e.jsx(ua,{})}),e.jsx(T,{path:"/oauth/callback",element:e.jsx(xa,{})}),e.jsx(T,{path:"/agence",element:e.jsx(ga,{})}),e.jsx(T,{path:"/settings",element:e.jsx(fa,{})})]})})]})})})})}const ct=document.getElementById("root");if(!ct)throw new Error("Failed to find root element");We(ct).render(e.jsx(ft.StrictMode,{children:e.jsx(ba,{})}));
